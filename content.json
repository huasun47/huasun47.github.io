{"posts":[{"title":"å‰ªè´´æ¿æ“ä½œ Clipboard API","text":"ä»‹ç»ä¸€å…±æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥å®ç°å‰ªè´´æ¿æ“ä½œ Document.execCommand()æ–¹æ³• å¼‚æ­¥çš„ Clipboard API copy äº‹ä»¶å’Œ paste äº‹ä»¶ Document.execCommand()Document.execCommand() æ˜¯æ“ä½œå‰ªè´´æ¿çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œå„ç§æµè§ˆå™¨éƒ½æ”¯æŒï¼Œæ”¯æŒå¤åˆ¶ã€å‰ªåˆ‡å’Œç²˜è´´è¿™ä¸‰ä¸ªæ“ä½œã€‚ document.execCommand(â€˜copyâ€™)ï¼ˆå¤åˆ¶ï¼‰ document.execCommand(â€˜cutâ€™)ï¼ˆå‰ªåˆ‡ï¼‰ document.execCommand(â€˜pasteâ€™)ï¼ˆç²˜è´´ï¼‰ å¤åˆ¶ï¼š å¤åˆ¶æ—¶ï¼Œå…ˆé€‰ä¸­æ–‡æœ¬ï¼Œç„¶åè°ƒç”¨ document.execCommand('copy')ï¼Œé€‰ä¸­çš„æ–‡æœ¬å°±ä¼šè¿›å…¥å‰ªè´´æ¿ 123const inputElement = document.querySelector(&quot;#input&quot;);inputElement.select();document.execCommand(&quot;copy&quot;); ç²˜è´´ç²˜è´´æ—¶ï¼Œè°ƒç”¨document.execCommand('paste')ï¼Œå°±ä¼šå°†å‰ªè´´æ¿é‡Œé¢çš„å†…å®¹ï¼Œè¾“å‡ºåˆ°å½“å‰çš„ç„¦ç‚¹å…ƒç´ ä¸­ 123const pasteText = document.querySelector(&quot;#output&quot;);pasteText.focus();document.execCommand(&quot;paste&quot;); ç¼ºç‚¹ï¼š é¦–å…ˆï¼Œå®ƒåªèƒ½å°†é€‰ä¸­çš„å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œæ— æ³•å‘å‰ªè´´æ¿ä»»æ„å†™å…¥å†…å®¹ã€‚ å…¶æ¬¡ï¼Œå®ƒæ˜¯åŒæ­¥æ“ä½œï¼Œå¦‚æœå¤åˆ¶/ç²˜è´´å¤§é‡æ•°æ®ï¼Œé¡µé¢ä¼šå‡ºç°å¡é¡¿ã€‚æœ‰äº›æµè§ˆå™¨è¿˜ä¼šè·³å‡ºæç¤ºæ¡†ï¼Œè¦æ±‚ç”¨æˆ·è®¸å¯ï¼Œè¿™æ—¶åœ¨ç”¨æˆ·åšå‡ºé€‰æ‹©å‰ï¼Œé¡µé¢ä¼šå¤±å»å“åº” ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œè¿˜æ˜¯ä½¿ç”¨ Clipboard API å¼‚æ­¥ Clipboard APIæ¯”ä¼ ç»Ÿçš„document.execCommand()æ–¹æ³•æ›´å¼ºå¤§ã€æ›´åˆç†ã€‚ å®ƒçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè¿”å› Promise å¯¹è±¡ï¼Œä¸ä¼šé€ æˆé¡µé¢å¡é¡¿ã€‚è€Œä¸”ï¼Œå®ƒå¯ä»¥å°†ä»»æ„å†…å®¹ï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰æ”¾å…¥å‰ªè´´æ¿ã€‚ navigator.clipboard å±æ€§è¿”å› Clipboard å¯¹è±¡ï¼Œæ‰€æœ‰æ“ä½œéƒ½é€šè¿‡è¿™ä¸ªå¯¹è±¡è¿›è¡Œ 12// å¦‚æœnavigator.clipboardå±æ€§è¿”å›undefinedï¼Œå°±è¯´æ˜å½“å‰æµè§ˆå™¨ï¼Œä¸æ”¯æŒè¿™ä¸ª APIconst clipboardObj = navigator.clipboard; ç”±äºç”¨æˆ·å¯èƒ½æŠŠæ•æ„Ÿæ•°æ®ï¼ˆæ¯”å¦‚å¯†ç ï¼‰æ”¾åœ¨å‰ªè´´æ¿ï¼Œå…è®¸è„šæœ¬ä»»æ„è¯»å–ä¼šäº§ç”Ÿå®‰å…¨é£é™©ï¼Œæ‰€ä»¥è¿™ä¸ª API çš„å®‰å…¨é™åˆ¶æ¯”è¾ƒå¤šã€‚ é¦–å…ˆï¼ŒChrome æµè§ˆå™¨è§„å®šï¼Œåªæœ‰ HTTPS åè®®çš„é¡µé¢æ‰èƒ½ä½¿ç”¨è¿™ä¸ª APIã€‚ã€å¼€å‘ç¯å¢ƒ localhost ä¹Ÿå¯ä»¥ã€‘ å…¶æ¬¡ï¼Œè°ƒç”¨æ—¶éœ€è¦æ˜ç¡®è·å¾—ç”¨æˆ·çš„è®¸å¯ã€‚æƒé™çš„å…·ä½“å®ç°ä½¿ç”¨äº† Permissions APIï¼Œè·Ÿå‰ªè´´æ¿ç›¸å…³çš„æœ‰ä¸¤ä¸ªæƒé™ï¼šclipboard-writeï¼ˆå†™æƒé™ï¼‰å’Œclipboard-readï¼ˆè¯»æƒé™ï¼‰ã€‚â€å†™æƒé™â€è‡ªåŠ¨æˆäºˆè„šæœ¬ï¼Œè€Œâ€è¯»æƒé™â€å¿…é¡»ç”¨æˆ·æ˜ç¡®åŒæ„ç»™äºˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå†™å…¥å‰ªè´´æ¿ï¼Œè„šæœ¬å¯ä»¥è‡ªåŠ¨å®Œæˆï¼Œä½†æ˜¯è¯»å–å‰ªè´´æ¿æ—¶ï¼Œæµè§ˆå™¨ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦åŒæ„è¯»å–ã€‚ Clipboard å¯¹è±¡Clipboard å¯¹è±¡æä¾›äº†å››ä¸ªæ–¹æ³•ï¼Œç”¨æ¥è¯»å†™å‰ªè´´æ¿ã€‚å®ƒä»¬éƒ½æ˜¯å¼‚æ­¥æ–¹æ³•ï¼Œè¿”å› Promise å¯¹è±¡ Clipboard.readText() ç”¨äºå¤åˆ¶å‰ªè´´æ¿é‡Œé¢çš„æ–‡æœ¬æ•°æ® 12345678document.body.addEventListener(&quot;click&quot;, async (e) =&gt; { try { const text = await navigator.clipboard.readText(); console.log(text); } catch { console.log(&quot;ç”¨æˆ·æ‹’ç»è¯»å–&quot;); }}); Clipboard.read() ç”¨äºå¤åˆ¶å‰ªè´´æ¿é‡Œé¢çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰ã€‚è¯¥æ–¹æ³•éœ€è¦ç”¨æˆ·æ˜ç¡®ç»™äºˆè®¸å¯ã€‚ è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚ä¸€æ—¦è¯¥å¯¹è±¡çš„çŠ¶æ€å˜ä¸º resolvedï¼Œå°±å¯ä»¥è·å¾—ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„æˆå‘˜éƒ½æ˜¯ ClipboardItem å¯¹è±¡çš„å®ä¾‹ã€‚ 12345678910111213async function getClipboardContents() { try { const clipboardItems = await navigator.clipboard.read(); for (const clipboardItem of clipboardItems) { for (const type of clipboardItem.types) { const blob = await clipboardItem.getType(type); console.log(URL.createObjectURL(blob)); } } } catch (err) { console.error(err.name, err.message); }} ClipboardItem å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„å‰ªè´´é¡¹ï¼Œæ¯ä¸ªå‰ªè´´é¡¹éƒ½æ‹¥æœ‰ ClipboardItem.types å±æ€§å’Œ ClipboardItem.getType()æ–¹æ³•ã€‚ ClipboardItem.types å±æ€§è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢çš„æˆå‘˜æ˜¯è¯¥å‰ªè´´é¡¹å¯ç”¨çš„ MIME ç±»å‹ï¼Œæ¯”å¦‚æŸä¸ªå‰ªè´´é¡¹å¯ä»¥ç”¨ HTML æ ¼å¼ç²˜è´´ï¼Œä¹Ÿå¯ä»¥ç”¨çº¯æ–‡æœ¬æ ¼å¼ç²˜è´´ï¼Œé‚£ä¹ˆå®ƒå°±æœ‰ä¸¤ä¸ª MIME ç±»å‹ï¼ˆtext/html å’Œ text/plainï¼‰ã€‚ ClipboardItem.getType(type)æ–¹æ³•ç”¨äºè¯»å–å‰ªè´´é¡¹çš„æ•°æ®ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚è¯¥æ–¹æ³•æ¥å—å‰ªè´´é¡¹çš„ MIME ç±»å‹ä½œä¸ºå‚æ•°ï¼Œè¿”å›è¯¥ç±»å‹çš„æ•°æ®ï¼Œè¯¥å‚æ•°æ˜¯å¿…éœ€çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ Clipboard.writeText() æ–¹æ³•ç”¨äºå°†æ–‡æœ¬å†…å®¹å†™å…¥å‰ªè´´æ¿ 123document.body.addEventListener(&quot;click&quot;, async (e) =&gt; { await navigator.clipboard.writeText(&quot;Yo&quot;);}); Clipboard.write() æ–¹æ³•ç”¨äºå°†ä»»æ„æ•°æ®å†™å…¥å‰ªè´´æ¿ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚ è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ª ClipboardItem å®ä¾‹ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå†™å…¥å‰ªè´´æ¿çš„æ•°æ® 12345678910111213try { const imgURL = &quot;https://dummyimage.com/300.png&quot;; const data = await fetch(imgURL); const blob = await data.blob(); await navigator.clipboard.write([ new ClipboardItem({ [blob.type]: blob, }), ]); console.log(&quot;Image copied.&quot;);} catch (err) { console.error(err.name, err.message);} copy äº‹ä»¶ï¼Œcut äº‹ä»¶ç”¨æˆ·å‘å‰ªè´´æ¿æ”¾å…¥æ•°æ®æ—¶ï¼Œå°†è§¦å‘ copy äº‹ä»¶ 1234567const source = document.querySelector(&quot;.source&quot;);source.addEventListener(&quot;copy&quot;, (event) =&gt; { const selection = document.getSelection(); event.clipboardData.setData(&quot;text/plain&quot;, selection.toString().toUpperCase()); event.preventDefault();}); äº‹ä»¶å¯¹è±¡çš„ clipboardData å±æ€§åŒ…å«äº†å‰ªè´´æ¿æ•°æ®ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å±æ€§å’Œæ–¹æ³• Event.clipboardData.setData(type, data)ï¼šä¿®æ”¹å‰ªè´´æ¿æ•°æ®ï¼Œéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚ Event.clipboardData.getData(type)ï¼šè·å–å‰ªè´´æ¿æ•°æ®ï¼Œéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚ Event.clipboardData.clearData([type])ï¼šæ¸…é™¤å‰ªè´´æ¿æ•°æ®ï¼Œå¯ä»¥æŒ‡å®šæ•°æ®ç±»å‹ã€‚å¦‚æœä¸æŒ‡å®šç±»å‹ï¼Œå°†æ¸…é™¤æ‰€æœ‰ç±»å‹çš„æ•°æ®ã€‚ Event.clipboardData.itemsï¼šä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰å‰ªè´´é¡¹ï¼Œä¸è¿‡é€šå¸¸åªæœ‰ä¸€ä¸ªå‰ªè´´é¡¹ã€‚ ä¸‹é¢æ˜¯æ‹¦æˆªç”¨æˆ·å¤åˆ¶ ğŸ‘‡ 12345678910111213141516171819202122const clipboardItems = [];document.addEventListener(&quot;copy&quot;, async (e) =&gt; { e.preventDefault(); try { let clipboardItems = []; for (const item of e.clipboardData.items) { if (!item.type.startsWith(&quot;image/&quot;)) { continue; } clipboardItems.push( new ClipboardItem({ [item.type]: item, }) ); await navigator.clipboard.write(clipboardItems); console.log(&quot;Image copied.&quot;); } } catch (err) { console.error(err.name, err.message); }}); paste äº‹ä»¶ç”¨æˆ·ä½¿ç”¨å‰ªè´´æ¿æ•°æ®ï¼Œè¿›è¡Œç²˜è´´æ“ä½œæ—¶ï¼Œä¼šè§¦å‘ paste äº‹ä»¶ã€‚ 12345document.addEventListener(&quot;paste&quot;, async (e) =&gt; { e.preventDefault(); const text = await navigator.clipboard.readText(); console.log(&quot;Pasted text: &quot;, text);});","link":"/2022/06/04/%E6%95%99%E7%A8%8B/Clipboard%20API%E6%95%99%E7%A8%8B/"},{"title":"JavaScript ä¾¦æµ‹æ‰‹æœºæµè§ˆå™¨çš„äº”ç§æ–¹æ³•","text":"ä¾¦æµ‹æ–¹æ³•navigator.userAgentJS é€šè¿‡ navigator.userAgent å±æ€§æ‹¿åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œåªè¦é‡Œé¢åŒ…å« mobiã€androidã€iphone ç­‰å…³é”®å­—ï¼Œå°±å¯ä»¥è®¤å®šæ˜¯ç§»åŠ¨è®¾å¤‡ã€‚ 123456789101112if (/Mobi|Android|iPhone/i.test(navigator.userAgent)) { // å½“å‰è®¾å¤‡æ˜¯ç§»åŠ¨è®¾å¤‡}// å¦ä¸€ç§å†™æ³•if ( navigator.userAgent.match(/Mobi/i) || navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/iPhone/i)) { // å½“å‰è®¾å¤‡æ˜¯ç§»åŠ¨è®¾å¤‡} ç¼ºç‚¹: ä¸å¯é ï¼Œå› ä¸ºç”¨æˆ·å¯ä»¥ä¿®æ”¹è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè®©æ‰‹æœºæµè§ˆå™¨ä¼ªè£…æˆæ¡Œé¢æµè§ˆå™¨ æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå·²ç»åºŸé™¤çš„ navigator.platform å±æ€§ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨ã€‚å®ƒè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç”¨æˆ·çš„æ“ä½œç³»ç»Ÿã€‚ 123if (/Android|iPhone|iPad|iPod/i.test(navigator.platform)) { // å½“å‰è®¾å¤‡æ˜¯ç§»åŠ¨è®¾å¤‡} window.screenï¼Œwindow.innerWidthé€šè¿‡å±å¹•å®½åº¦ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæ‰‹æœºã€‚window.screen å¯¹è±¡è¿”å›ç”¨æˆ·è®¾å¤‡çš„å±å¹•ä¿¡æ¯ï¼Œè¯¥å¯¹è±¡çš„ width å±æ€§æ˜¯å±å¹•å®½åº¦ï¼ˆå•ä½ä¸ºåƒç´ ï¼‰ 123if (window.screen.width &lt; 500) { // å½“å‰è®¾å¤‡æ˜¯ç§»åŠ¨è®¾å¤‡} ç¼ºç‚¹ï¼šå¦‚æœæ‰‹æœºæ¨ªå±ä½¿ç”¨ï¼Œå°±è¯†åˆ«ä¸äº†ã€‚å¦ä¸€ä¸ªå±æ€§ window.innerWidth è¿”å›æµè§ˆå™¨çª—å£é‡Œé¢çš„ç½‘é¡µå¯è§éƒ¨åˆ†çš„å®½åº¦ï¼Œæ¯”è¾ƒé€‚åˆæŒ‡å®šç½‘é¡µåœ¨ä¸åŒå®½åº¦ä¸‹çš„æ ·å¼ 1234567891011const getBrowserWidth = function () { if (window.innerWidth &lt; 768) { return &quot;xs&quot;; } else if (window.innerWidth &lt; 991) { return &quot;sm&quot;; } else if (window.innerWidth &lt; 1199) { return &quot;md&quot;; } else { return &quot;lg&quot;; }}; window.orientationä¾¦æµ‹å±å¹•æ–¹å‘ï¼Œæ‰‹æœºå±å¹•å¯ä»¥éšæ—¶æ”¹å˜æ–¹å‘ï¼ˆæ¨ªå±æˆ–ç«–å±ï¼‰ï¼Œæ¡Œé¢è®¾å¤‡åšä¸åˆ°window.orientation å±æ€§ç”¨äºè·å–å±å¹•çš„å½“å‰æ–¹å‘ï¼Œåªæœ‰ç§»åŠ¨è®¾å¤‡æ‰æœ‰è¿™ä¸ªå±æ€§ï¼Œæ¡Œé¢è®¾å¤‡ä¼šè¿”å› undefined 1234// iPhone çš„ Safari æµè§ˆå™¨ä¸æ”¯æŒè¯¥å±æ€§if (typeof window.orientation !== &quot;undefined&quot;) { // å½“å‰è®¾å¤‡æ˜¯ç§»åŠ¨è®¾å¤‡} touch äº‹ä»¶æ‰‹æœºæµè§ˆå™¨çš„ DOM å…ƒç´ å¯ä»¥é€šè¿‡ ontouchstart å±æ€§ï¼Œä¸º touch äº‹ä»¶æŒ‡å®šç›‘å¬å‡½æ•°ã€‚æ¡Œé¢è®¾å¤‡æ²¡æœ‰è¿™ä¸ªå±æ€§ 12345678910111213function isMobile() { return &quot;ontouchstart&quot; in document.documentElement;}// å¦ä¸€ç§å†™æ³•function isMobile() { try { document.createEvent(&quot;TouchEvent&quot;); return true; } catch (e) { return false; }} window.matchMedia()CSS é€šè¿‡ media queryï¼ˆåª’ä»‹æŸ¥è¯¢ï¼‰ä¸ºç½‘é¡µæŒ‡å®šå“åº”å¼æ ·å¼ã€‚ window.matchMedia() æ–¹æ³•æ¥å—ä¸€ä¸ª CSS çš„ media query è¯­å¥ä½œä¸ºå‚æ•°ï¼Œåˆ¤æ–­è¿™ä¸ªè¯­å¥æ˜¯å¦ç”Ÿæ•ˆã€‚ 1let isMobile = window.matchMedia(&quot;only screen and (max-width: 760px)&quot;).matches; é™¤äº†é€šè¿‡å±å¹•å®½åº¦åˆ¤æ–­ï¼Œè¿˜å¯ä»¥é€šè¿‡æŒ‡é’ˆçš„ç²¾ç¡®æ€§åˆ¤æ–­ã€‚ 12// ç”±äºæ‰‹æœºä¸æ”¯æŒé¼ æ ‡ï¼Œåªæ”¯æŒè§¦æ‘¸ï¼Œæ‰€ä»¥ç¬¦åˆè¿™ä¸ªæ¡ä»¶let isMobile = window.matchMedia(&quot;(pointer:coarse)&quot;).matches; æœ‰äº›è®¾å¤‡æ”¯æŒå¤šç§æŒ‡é’ˆï¼Œæ¯”å¦‚åŒæ—¶æ”¯æŒé¼ æ ‡å’Œè§¦æ‘¸ã€‚pointer:coarse åªç”¨æ¥åˆ¤æ–­ä¸»æŒ‡é’ˆï¼Œæ­¤å¤–è¿˜æœ‰ä¸€ä¸ª any-pointer å‘½ä»¤åˆ¤æ–­æ‰€æœ‰æŒ‡é’ˆ 12// any-pointer:coarseè¡¨ç¤ºæ‰€æœ‰æŒ‡é’ˆé‡Œé¢ï¼Œåªè¦æœ‰ä¸€ä¸ªæŒ‡é’ˆæ˜¯ä¸ç²¾ç¡®çš„ï¼Œå°±ç¬¦åˆæŸ¥è¯¢æ¡ä»¶let isMobile = window.matchMedia(&quot;(any-pointer:coarse)&quot;).matches; å·¥å…· js ä¾¦æµ‹æ¨è react-device-detectï¼Œå®ƒæ”¯æŒå¤šç§ç²’åº¦çš„è®¾å¤‡ä¾¦æµ‹ã€‚ 12345import { isMobile } from &quot;react-device-detect&quot;;if (isMobile) { // å½“å‰è®¾å¤‡æ˜¯ç§»åŠ¨è®¾å¤‡}","link":"/2021/08/21/%E6%95%99%E7%A8%8B/JavaScript%20%E4%BE%A6%E6%B5%8B%E6%89%8B%E6%9C%BA%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E4%BA%94%E7%A7%8D%E6%96%B9%E6%B3%95/"},{"title":"JavaScript å†…å­˜æ³„æ¼","text":"ä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼?ç¨‹åºçš„è¿è¡Œéœ€è¦å†…å­˜ã€‚åªè¦ç¨‹åºæå‡ºè¦æ±‚ï¼Œæ“ä½œç³»ç»Ÿæˆ–è€…è¿è¡Œæ—¶ï¼ˆruntimeï¼‰å°±å¿…é¡»ä¾›ç»™å†…å­˜ã€‚ å¯¹äºæŒç»­è¿è¡Œçš„æœåŠ¡è¿›ç¨‹ï¼ˆdaemonï¼‰ï¼Œå¿…é¡»åŠæ—¶é‡Šæ”¾ä¸å†ç”¨åˆ°çš„å†…å­˜ã€‚å¦åˆ™ï¼Œå†…å­˜å ç”¨è¶Šæ¥è¶Šé«˜ï¼Œè½»åˆ™å½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œé‡åˆ™å¯¼è‡´è¿›ç¨‹å´©æºƒ ä¸å†ç”¨åˆ°çš„å†…å­˜ï¼Œæ²¡æœ‰åŠæ—¶é‡Šæ”¾ï¼Œå°±å«åšå†…å­˜æ³„æ¼ï¼ˆmemory leakï¼‰ æ‰€æœ‰é«˜çº§è¯­è¨€éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç®¡ç†ç³»ç»Ÿï¼Œè€Œ js çš„å†…å­˜ç®¡ç†ä¹ŸåŒ…å«åœ¨ v8 ä¸­ã€‚æä¾›è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œç§°ä¸ºâ€åƒåœ¾å›æ”¶æœºåˆ¶â€ åƒåœ¾å›æ”¶æœºåˆ¶åƒåœ¾å›æ”¶æœºåˆ¶æ€ä¹ˆçŸ¥é“ï¼Œå“ªäº›å†…å­˜ä¸å†éœ€è¦å‘¢ï¼Ÿ å¼•ç”¨è®¡æ•°ï¼šè¯­è¨€å¼•æ“æœ‰ä¸€å¼ â€å¼•ç”¨è¡¨â€ï¼Œä¿å­˜äº†å†…å­˜é‡Œé¢æ‰€æœ‰çš„èµ„æºï¼ˆé€šå¸¸æ˜¯å„ç§å€¼ï¼‰çš„å¼•ç”¨æ¬¡æ•°ã€‚å¦‚æœä¸€ä¸ªå€¼çš„å¼•ç”¨æ¬¡æ•°æ˜¯ 0ï¼Œå°±è¡¨ç¤ºè¿™ä¸ªå€¼ä¸å†ç”¨åˆ°äº†ï¼Œå› æ­¤å¯ä»¥å°†è¿™å—å†…å­˜é‡Šæ”¾ é‚£ä¹ˆï¼Œä¸€ä¸ªå€¼ä¸å†éœ€è¦äº†ï¼Œå¼•ç”¨æ•°å´ä¸ä¸º 0ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶æ— æ³•é‡Šæ”¾è¿™å—å†…å­˜ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„æ¼ ç¤ºä¾‹ï¼š 1234567// åœ°å€ arrï¼Œ åœ°å€: æ•°ç»„å€¼. æ­¤æ—¶ æ•°ç»„å€¼çš„&lt;å¼•ç”¨æ¬¡æ•°&gt;æ˜¯ 1let arr = [1, 2, 3, 4];console.log(&quot;hello world&quot;);// è§£é™¤å¯¹æ•°ç»„å€¼çš„å¼•ç”¨arr = null;// æˆ–è€…å¯ä»¥æ¢ä½å…¶ä»–å€¼, æ€»ä¹‹å°±æ˜¯ä¸ç”¨è¿™ä¸ªæ•°ç»„äº†ï¼Œé‚£å£°æ˜çš„æ•°ç»„å€¼ä¼šè¢«æ¸…ç†æ‰arr = undefined; å†…å­˜æ³„æ¼çš„è¯†åˆ«æ–¹æ³•å¦‚æœè¿ç»­äº”æ¬¡åƒåœ¾å›æ”¶ä¹‹åï¼Œå†…å­˜å ç”¨ä¸€æ¬¡æ¯”ä¸€æ¬¡å¤§ï¼Œå°±æœ‰å†…å­˜æ³„æ¼ã€‚è¿™å°±è¦æ±‚å®æ—¶æŸ¥çœ‹å†…å­˜å ç”¨ æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œé€‰æ‹© æ€§èƒ½ï¼ˆperformanceï¼‰ é¢æ¿ åœ¨é¡¶éƒ¨çš„ æ ç›®é‡Œé¢å‹¾é€‰ Memory ç‚¹å‡»å·¦ä¸Šè§’çš„å½•åˆ¶æŒ‰é’®ã€‚ åœ¨é¡µé¢ä¸Šè¿›è¡Œå„ç§æ“ä½œï¼Œæ¨¡æ‹Ÿç”¨æˆ·çš„ä½¿ç”¨æƒ…å†µã€‚ ä¸€æ®µæ—¶é—´åï¼Œç‚¹å‡»å¯¹è¯æ¡†çš„ stop æŒ‰é’®ï¼Œé¢æ¿ä¸Šå°±ä¼šæ˜¾ç¤ºè¿™æ®µæ—¶é—´çš„å†…å­˜å ç”¨æƒ…å†µã€‚ ç»“æœåˆ¤å®šï¼š å¦‚æœå†…å­˜å ç”¨åŸºæœ¬å¹³ç¨³ï¼Œæ¥è¿‘æ°´å¹³ï¼Œå°±è¯´æ˜ä¸å­˜åœ¨å†…å­˜æ³„æ¼ å¦‚æœéšç€ä½ çš„æ“ä½œï¼Œå†…å­˜çº¿ä¸æ–­å‡é«˜ï¼Œé‚£ä¹ˆå°±è¦å°å¿ƒäº† Nodejs æŸ¥çœ‹å½“å‰å†…å­˜process.memoryUsage() 12345678/** { rssï¼ˆresident set sizeï¼‰ï¼šæ‰€æœ‰å†…å­˜å ç”¨ï¼ŒåŒ…æ‹¬æŒ‡ä»¤åŒºå’Œå †æ ˆã€‚ heapTotalï¼š&quot;å †&quot;å ç”¨çš„å†…å­˜ï¼ŒåŒ…æ‹¬ç”¨åˆ°çš„å’Œæ²¡ç”¨åˆ°çš„ã€‚ heapUsedï¼šç”¨åˆ°çš„å †çš„éƒ¨åˆ†ã€‚ externalï¼š V8 å¼•æ“å†…éƒ¨çš„ C++ å¯¹è±¡å ç”¨çš„å†…å­˜ã€‚ } */ åˆ¤æ–­å†…å­˜æ³„æ¼ï¼Œä»¥ heapUsed å­—æ®µä¸ºå‡† WeakMapåœ¨æ–°å»ºå¼•ç”¨çš„æ—¶å€™å°±å£°æ˜ï¼Œå“ªäº›å¼•ç”¨å¿…é¡»æ‰‹åŠ¨æ¸…é™¤ï¼Œå“ªäº›å¼•ç”¨å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå½“å…¶ä»–å¼•ç”¨æ¶ˆå¤±ä»¥åï¼Œåƒåœ¾å›æ”¶æœºåˆ¶å°±å¯ä»¥é‡Šæ”¾å†…å­˜ã€‚ å¯ä»¥ç”¨ WeakSet å’Œ WeakMap å®ç°ï¼Œå®ƒä»¬å¯¹äºå€¼çš„å¼•ç”¨éƒ½æ˜¯ä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶çš„ï¼Œæ‰€ä»¥åå­—é‡Œé¢æ‰ä¼šæœ‰ä¸€ä¸ªâ€Weakâ€ï¼Œè¡¨ç¤ºè¿™æ˜¯å¼±å¼•ç”¨ å¦‚ä½•ä½¿ç”¨ WeakMapï¼š 1234567const wm = new WeakMap();// æ­¤æ—¶ dom èŠ‚ç‚¹çš„ å¼•ç”¨æ•°ä¸º 1const element = document.getElementById(&quot;example&quot;);// æ­¤æ—¶ dom èŠ‚ç‚¹çš„å¼•ç”¨æ•°ä»æ˜¯ 1. å¦‚æœæ˜¯ &lt;Map&gt; è€Œä¸æ˜¯ &lt;WeakMap&gt; é‚£ä¹ˆ dom èŠ‚ç‚¹çš„å¼•ç”¨æ•°æ˜¯ 2wm.set(element, &quot;some information&quot;);wm.get(element); // &quot;some information&quot;// æµè§ˆå™¨å†…æ— æ³•è§‚å¯Ÿåˆ°è¢«å›æ”¶ WeakMap æ˜¾ç¤ºå†…å­˜ç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061# é¦–å…ˆï¼Œæ‰“å¼€ Node å‘½ä»¤è¡Œã€‚--expose-gcå‚æ•°è¡¨ç¤ºå…è®¸æ‰‹åŠ¨æ‰§è¡Œåƒåœ¾å›æ”¶æœºåˆ¶node --expose-gc# æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œä¿è¯è·å–çš„å†…å­˜ä½¿ç”¨çŠ¶æ€å‡†ç¡®&gt; global.gc();undefined# æŸ¥çœ‹å†…å­˜å ç”¨çš„åˆå§‹çŠ¶æ€ï¼ŒheapUsed ä¸º 4M å·¦å³&gt; process.memoryUsage();{ rss: 21106688, heapTotal: 7376896, heapUsed: 4339536, external: 9059 }&gt; let wm = new WeakMap();undefined&gt; let b = new Object();undefined&gt; global.gc();undefined# æ­¤æ—¶ï¼ŒheapUsed ä»ç„¶ä¸º 4M å·¦å³&gt; process.memoryUsage();{ rss: 20537344, heapTotal: 9474048, heapUsed: 4620568, external: 8993 }# åœ¨ WeakMap ä¸­æ·»åŠ ä¸€ä¸ªé”®å€¼å¯¹ï¼Œ# é”®åä¸ºå¯¹è±¡ bï¼Œé”®å€¼ä¸ºä¸€ä¸ª 5*1024*1024 çš„æ•°ç»„&gt; wm.set(b, new Array(5*1024*1024));WeakMap {}# æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡åƒåœ¾å›æ”¶&gt; global.gc();undefined# æ­¤æ—¶ï¼ŒheapUsed ä¸º 46M å·¦å³&gt; process.memoryUsage();{ rss: 62652416, heapTotal: 51437568, heapUsed: 46608096, external: 8951 }# è§£é™¤å¯¹è±¡ b çš„å¼•ç”¨&gt; b = null;null# å†æ¬¡æ‰§è¡Œåƒåœ¾å›æ”¶&gt; global.gc();undefined# è§£é™¤ b çš„å¼•ç”¨ä»¥åï¼ŒheapUsed å˜å› 4M å·¦å³# è¯´æ˜ WeakMap ä¸­çš„é‚£ä¸ªé•¿åº¦ä¸º 5*1024*1024 çš„æ•°ç»„è¢«é”€æ¯äº†&gt; process.memoryUsage();{ rss: 20639744, heapTotal: 8425472, heapUsed: 4529984, external: 8956 } ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦å¤–éƒ¨çš„å¼•ç”¨æ¶ˆå¤±ï¼ŒWeakMap å†…éƒ¨çš„å¼•ç”¨ï¼Œå°±ä¼šè‡ªåŠ¨è¢«åƒåœ¾å›æ”¶æ¸…é™¤ã€‚å¦‚æœä½ è¦å¾€å¯¹è±¡ä¸Šæ·»åŠ æ•°æ®ï¼Œåˆä¸æƒ³å¹²æ‰°åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ WeakMap ä¹Ÿå°±æ˜¯ WeakMap å’Œ WeakSet å¯¹ å¼•ç”¨å€¼æœ‰å…³è”æ€§è€Œä¸” WeakSet çš„ value å€¼ï¼ŒWeakMap çš„ key, åªèƒ½æ˜¯å¯¹è±¡","link":"/2021/05/17/%E6%95%99%E7%A8%8B/JavaScript%20%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%95%99%E7%A8%8B/"},{"title":"MIDI Clef è½¯ä»¶ åˆ¶ä½œ8bitæ›²é£","text":"å‰æ éœ€è¦é…åˆå®‰å“æ‰‹æœºå®Œæˆ éœ€è¦ç”¨é’¢ç´æ›²çš„éŸ³ä¹æ–‡ä»¶ç»“å°¾ .mid æˆ– .midi MP3 åœ¨çº¿è½¬ .midi å…è´¹ä¸‹è½½ midi ç½‘ç«™ https://bitmidi.com/ ç±»ä¼¼ç½‘ç«™è¯·è‡ªæœ è°·æ­Œåº”ç”¨å•†åº—ä¸‹è½½ MIDI Clef ç‚¹å‡» OpenFile æ‰“å¼€ .mid æ–‡ä»¶ ç‚¹å‡» 01ï¼Œä¹Ÿå°±æ˜¯éŸ³è½¨ï¼Œé’¢ç´æ›²ä¸åŒäºæˆ‘ä»¬å¹³æ—¶å¬åˆ°çš„éŸ³ä¹ï¼Œå§‹ç»ˆåªæœ‰ä¸€æ¡éŸ³è½¨ã€‚æ­¤æ—¶å°±ç›¸å½“äºç»™è¿™æ¡éŸ³è½¨åŠ ä¸Šâ€œæ»¤é•œâ€ ç‚¹å‡»åï¼Œå³ä¾§ä¼šå¼¹å‡ºä¸€ä¸ª drawerã€‚ä¸‹æ‹‰åˆ° Synth Lead çš„éŸ³æ•ˆé€‰æ‹©ä¸Šã€‚ç‚¹å‡» Saw Wave å°±ä¼šæ”¹å˜éŸ³æ•ˆ è¿˜æœ‰æ›´å¤šéŸ³æ•ˆå¾…æ¢ç´¢ã€‚ã€‚ã€‚ â€‹","link":"/2022/09/18/%E6%95%99%E7%A8%8B/MIDI%20Clef%20%E8%BD%AF%E4%BB%B6%20%E5%88%B6%E4%BD%9C8bit%E6%9B%B2%E9%A3%8E/"},{"title":"JavaScript çš„ this åŸç†","text":"å¯¹ this çš„å®šä¹‰this æŒ‡çš„æ˜¯å‡½æ•°è¿è¡Œæ—¶æ‰€åœ¨çš„ç¯å¢ƒ æ¡ˆä¾‹è§£ææ¥çœ‹ä¸€ä¸ªç»å…¸æ¡ˆä¾‹ï¼š 123456789101112var obj = { foo: function () { console.log(this.bar); }, bar: 1,};var foo = obj.foo;var bar = 2;obj.foo(); // 1foo(); // 2 æˆ‘ä»¬å¹³æ—¶ç»å¸¸ç”¨åˆ°çš„ï¼š 1234567function name() { console.log(this);}// ç”±äºåœ¨æœ€å¤–å±‚è°ƒç”¨ï¼Œä¸€ä¸ªç½‘é¡µçš„æœ€å¤–å±‚å°±æ˜¯ Window å¯¹è±¡name(); // Window// ç”±äºè¿™é‡Œçš„ä»£ç å—ç”± å…ƒç´ #id æ‰€è°ƒç”¨ï¼Œæ‰€ä»¥è¿™é‡Œçš„thisï¼Œä¼šè¾“å‡ºè°ƒç”¨å®ƒçš„domdocument.querySelector(&quot;#id&quot;).onclick = name; js æ˜¯å¦‚ä½•å®šä¹‰å˜é‡çš„ï¼Ÿåˆ†ä¸¤ç§æƒ…å†µï¼Œé¦–å…ˆæ˜¯æ ˆç±»å‹var obj = { foo: 5 }; JavaScript å¼•æ“ä¼šå…ˆåœ¨å†…å­˜é‡Œé¢ï¼Œç”Ÿæˆä¸€ä¸ªå¯¹è±¡{ foo: 5 }ï¼Œç„¶åæŠŠè¿™ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€èµ‹å€¼ç»™å˜é‡ obj ä¹Ÿå°±æ˜¯è¯´ js ä½¿ç”¨äº†ä¸¤å—å†…å­˜ç©ºé—´ â€˜objâ€™ å’Œ â€˜{ foo: 5 }â€™ é‚£ä¹ˆä½¿ç”¨æ—¶ï¼Œæƒ³è¦è¯»å– obj.foo æ‹¿åˆ° 5ï¼Œå¼•æ“å…ˆä» obj æ‹¿åˆ°å†…å­˜åœ°å€ï¼Œç„¶åå†ä»è¯¥åœ°å€è¯»å‡ºåŸå§‹çš„å¯¹è±¡ï¼Œè¿”å›å®ƒçš„ foo å±æ€§ 12345678{ foo: { [[value]]: 5 [[writable]]: true [[enumerable]]: true [[configurable]]: true }} å †ç±»å‹var obj = { foo: function(){} }; å‡½æ•°å•ç‹¬ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç„¶åå†å°†å‡½æ•°çš„åœ°å€èµ‹å€¼ç»™ foo ä¹Ÿå°±æ˜¯è¯´ js ä½¿ç”¨äº†ä¸‰å—å†…å­˜ç©ºé—´ â€˜objâ€™, â€˜{ foo }â€™ å’Œ function(){} ç”±äºå‡½æ•°æ˜¯ä¸€å—å•ç‹¬çš„ç©ºé—´ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡æ‰§è¡Œï¼Œè¿™ä¹Ÿèƒ½å¤Ÿè§£é‡Šäº†ä¸Šé¢çš„æ¡ˆä¾‹ call, apply, bind å¯¹ this çš„å½±å“éƒ½æ˜¯æ”¹å˜ this çš„è¿è¡Œç¯å¢ƒ. æ¯”å¦‚è¯´æˆ‘ä»¬å¹³å¸¸ç”¨åˆ°çš„ä¸€äº›æ–¹æ³•ï¼ŒæŸ¥æ‰¾æ•°ç»„ä¸­æœ€å¤§å€¼ 123456789101112// ç”¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸¾ä¾‹var obj = { foo: function () { console.log(this); },};obj.foo.call(window); // æœ¬åº”è¾“å‡º obj çš„å‡½æ•°ï¼Œæ”¹åˆ°äº† Windowobj.foo.bind(window)(); // Window// æŸ¥æ‰¾æ•°ç»„æœ€å¤§å€¼ï¼Œè¿™é‡Œå¯¹ this æ²¡æœ‰ç”¨åˆ°å½±å“ï¼ŒæŠŠnullæ¢æˆ window æˆ– Math è¾“å‡ºä¹Ÿæ˜¯ä¸€æ ·çš„ç»“æœ// å› ä¸º apply æŠŠå‚æ•°è½¬åŒ–ä¸ºäº† max æ–¹æ³•å¯æ¥å—çš„æ ·å­ Math.max(1, 2, 3), è¿™å°±æ˜¯ å’Œ callçš„åŒºåˆ«Math.max.apply(null, [1, 2, 3]); ps:åªæ˜¯è°ƒç”¨æ—¶ä¼šæ”¹å˜ï¼Œä¸ä¼šæ°¸ä¹…æ”¹å˜ åŒ¿åå‡½æ•°åªå•çº¯ä½œä¸ºå‡½æ•°æ‰§è¡Œï¼Œæ²¡æœ‰æœ¬èº«çš„ this, åœ¨ åŒ¿åå‡½æ•°ä¸­çš„ this ä¼šå‘ä¸Šå±‚ä½œç”¨åŸŸæŸ¥æ‰¾ ğŸ‘†, ä¸æ”¯æŒ call, apply, bind çš„æ”¹å˜ 12345678var obj = { foo: () =&gt; { console.log(this); },};obj.foo(); // Windowobj.foo.call(obj); // Windowobj.foo.call(Array); // Window æ€»ç»“æˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œè°è°ƒç”¨äº†ä¸€å— functionï¼Œfunction ä¸­çš„ this å°±æŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡","link":"/2020/06/07/%E6%95%99%E7%A8%8B/JavaScript%20%E7%9A%84%20this%20%E5%8E%9F%E7%90%86/"},{"title":"Node è°ƒè¯•å·¥å…·","text":"ä¸ªäººæ¨èæµè§ˆå™¨è°ƒè¯•ï¼Œæ¶‰åŠæ›´å…¨é¢ï¼Œä¸»è¦å¯æŸ¥çœ‹ å†…å­˜ å’Œ æ€§èƒ½ ä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹ï¼š 12345678const http = require(&quot;http&quot;);const server = http.createServer((req, res) =&gt; { res.end(&quot;hello nodejs&quot;); debugger;});server.listen(6630); æµè§ˆå™¨è°ƒè¯•å¯ä»¥ç›´æ¥è®¿é—® http://localhost:6630/ ç„¶åç‚¹å‡»æ§åˆ¶å°å·¦ä¸Šè§’çš„ ç»¿è‰²å…­è¾¹å½¢ æˆ–è¾“å…¥ chrome://inspect, çœ‹åˆ° Remote Target é‡Œé¢æ­£åœ¨è¿è¡Œçš„ app.js ï¼Œç‚¹å‡»é“¾æ¥å°±ä¼šè·³è½¬åˆ°è°ƒè¯•é¡µé¢ VsCode è°ƒè¯•é¦–å…ˆè¦ä½¿ç”¨ debug æ¨¡å¼å¯åŠ¨æœåŠ¡ç¨‹åºï¼Œæ­¤æ—¶æœ€ä¸‹é¢çš„ä¿¡æ¯æ é¢œè‰²ä¼šæœ‰æ‰€å˜åŒ–ä¸èƒ½ ç›´æ¥ä½¿ç”¨ å‘½ä»¤è¡Œå¯åŠ¨ã€‚å¿…é¡»é€šè¿‡ç‚¹å‡»ç¼–è¯‘å™¨ åœ¨æ‰§è¡Œåˆ°æ–­ç‚¹æ—¶ï¼Œ å·¦ä¾§å˜é‡æ ä¼šç»™å‡ºè°ƒç”¨æ ˆï¼Œå¯ä»¥æŸ¥çœ‹æ‰§è¡Œæ—¶çš„å˜é‡ä¿¡æ¯ æ›´å¤šçš„è°ƒè¯•æ–¹æ³• Chrome è°ƒè¯• Chrome Dev Tool åšå®¢","link":"/2021/07/09/%E6%95%99%E7%A8%8B/Node%20%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7/"},{"title":"Shell å‘½ä»¤è¡ŒåŠ¨ç”»åˆ¶ä½œ","text":"By Nodejs, å»ºè®®ï¼Œæ‹¿å¯¹æ¯”åº¦é«˜çš„è§†é¢‘å»åˆ¶ä½œï¼Œæ•ˆæœæ›´å¥½ è§†é¢‘è½¬å›¾ç‰‡ 123456789# å®‰è£… ffmpeg ï¼ˆï¼‰brew install ffmpeg## æ£€æµ‹æ˜¯å¦å®‰è£… ffmpegffmpeg -h# ffmpeg -i è§†é¢‘è·¯å¾„[ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„] -r å¸§æ•° è¾“å‡ºå›¾ç‰‡è·¯å¾„ffmpeg -i ./assets/60f1bcc6321e9fda43c173c84b0391.mp4 -r 15 ./assets/images/%d.png è½¬åŒ–æ­¥éª¤å®Œæ•´æºç é‡Œå·²ç»æ ‡æ³¨æ­¥éª¤ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778const fs = require(&quot;fs&quot;);const { join, extname } = require(&quot;path&quot;);const { read, intToRGBA } = require(&quot;jimp&quot;);const { echo, exit } = require(&quot;shelljs&quot;);const floder = join(__dirname, &quot;./assets/images/&quot;);// å¦‚æœç”»é¢å¯¹æ¯”åº¦å«é«˜ï¼Œæ¨èä½¿ç”¨ const charts = `##### `// æ„æˆå­—ç¬¦ï¼š é¢œè‰²ç”± æ·±åˆ°æµ…, ä¹Ÿå¯ä»¥å¢åŠ ç¬¦å·const charts = `@&amp;$%=+!^*~- `;const maxIndex = charts.length - 1;const limitIndex = (num) =&gt; (num &gt; maxIndex ? maxIndex : num);fs.readdir(floder, undefined, (err, data) =&gt; { if (err) throw err; // 6. è¿‡æ»¤é png å¹¶æ’åº const files = data.filter((url) =&gt; extname(url) === &quot;.png&quot;); files.sort((a, b) =&gt; parseInt(a) - parseInt(b)); // 7. é€’å½’æ’­æ”¾ play(files);});const play = (files) =&gt; { const printFileName = files.shift(); print(printFileName); if (files.length) { setTimeout(() =&gt; { play(files); // ps: åœ¨ js ä¸­ æ—¶é—´å‡½æ•°ä¸å¯ä½¿ç”¨ å°æ•° æˆ– è´Ÿæ•°ï¼Œå¦åˆ™ä¼šç«‹å³æ‰§è¡Œ }, parseInt(1000 / 15)); // 15 å–å†³äº ffmpeg åˆ†å‰²çš„å¸§æ•° return; } exit(1);};const print = (fileName) =&gt; { let subCharts = &quot;&quot;; // 1. è¯»å–å›¾ç‰‡ const fileURL = join(floder, fileName); read(fileURL).then((image) =&gt; { // 2 è·å–å®½é«˜ ps: æ–¹æ³•ä¸å¯ç»“æ„ï¼Œä¼šæŠ¥é”™ const width = image.getWidth(); const height = image.getHeight(); // 6. è°ƒæ•´åˆé€‚çš„ç¼©æ”¾æ¯”ä¾‹ å¾ˆé‡è¦ const xScale = width / 220; const yScale = height / 40; for (let y = 0; y &lt; height; y += yScale) { for (let x = 0; x &lt; width; x += xScale) { const { r, g, b } = intToRGBA(image.getPixelColor(x, y)); // 3. è¯»å–åƒç´ ç‚¹ çš„ ç°åº¦å€¼ const gray = (0.3 * r + 0.59 * g + 0.11 * b).toFixed(2); // 4. ç®—å‡ºç°åº¦å€¼åœ¨ charts ä¸­è¡¨è¾¾çš„ä½ç½® const grayScale = parseFloat(gray / 255).toFixed(2); const grayDegree = parseInt(grayScale * charts.length); // +0.5 æ„Ÿè§‰æ›´äº®äº› const index = Math.floor(limitIndex(grayDegree + 0.5)); // 5. æ‹¼æ¥ subCharts += charts[index]; } subCharts += &quot;\\n&quot;; } echo(subCharts); });}; ç´ æé“¾æ¥ æ„Ÿè°¢ å¤§ä½¬ æä¾› go ç‰ˆæœ¬çš„æ•™ç¨‹","link":"/2021/04/25/%E6%95%99%E7%A8%8B/Shell%E5%8A%A8%E7%94%BB%E5%88%B6%E4%BD%9C/"},{"title":"Web Components å®ä¾‹","text":"ç®€ä»‹ç”± 4 é—¨æŠ€æœ¯ç»“åˆèµ·æ¥çš„ HTML Imports â€“&gt; HTML Modules HTML Templates Custom Elements Shadow DOM æˆç†Ÿçš„ç»„ä»¶åº“ç‰¹ç‚¹ï¼š éšå¤„å¤ç”¨ é£æ ¼ç»Ÿä¸€ åŠ¨æ•ˆè‡ªç„¶ å®ä¾‹æ¥çœ‹ä¸€ç»„ä¸‹é¢çš„å®ä¾‹ï¼Œè®²è¿°äº†å¦‚ä½•å®šä¹‰ web components å¹¶è·å– iframe ä¸­çš„ web components 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;!-- index.html --&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;å¼€å¯æœåŠ¡æ‰èƒ½è·å– iframe å†…å®¹&lt;/h1&gt; &lt;iframe src=&quot;./iframe.html&quot;&gt;&lt;/iframe&gt; &lt;fs-components&gt;&lt;/fs-components&gt; &lt;script&gt; customElements.define( &quot;fs-components&quot;, class extends HTMLElement { constructor() { super(); // ç›¸å½“äº Vue çš„ setup console.log(&quot;å…ˆè¿è¡Œæ„é€ å‡½æ•°&quot;); } connectedCallback() { // ç›¸å½“äº Vue çš„ mounted console.log(&quot;å†è¿è¡Œè¿æ¥å›è°ƒ&quot;); } disconnectedCallback() { // ç›¸å½“äº Vue çš„ unmounted console.log(&quot;å½“åˆ é™¤ç»„ä»¶æ—¶æ‰ä¼šè¿è¡Œå¤±è”å›è°ƒ&quot;); } adoptedCallback() { document.adoptNode(); alert(&quot;è¢«å¯¼å…¥&quot;); // document.adoptNode ä»å¤–éƒ¨æ–‡æ¡£å¯¼å…¥èŠ‚ç‚¹ï¼Œå‰ªåˆ‡å¼ (æœ‰è·¨åŸŸé™åˆ¶ğŸš«) // å½“ä½¿ç”¨ document.adoptNode åä¼šè§¦å‘è¯¥ç”Ÿå‘½å‘¨æœŸ console.log(&quot;å½“ä½¿ç”¨ document.adoptNode åä¼šè¿è¡Œæ”¶å…»å›è°ƒ&quot;); } attributeChangedCallback(name, oldValue, newValue) { // ç›¸å½“äº Vue çš„ watchï¼Œ å±æ€§å˜åŒ–æ—¶å›è°ƒ } } ); const iframe = document.querySelector(&quot;iframe&quot;); // å¯¹è‡ªèº«ç½‘é¡µä½¿ç”¨ä¸è§¦å‘ const selfComponent = document.querySelector(&quot;fs-components&quot;); document.body.appendChild(document.adoptNode(selfComponent)); // è·å–iframeä¸­çš„web-component iframe.onload = () =&gt; { const webComponent = iframe.contentDocument.querySelector(&quot;fancy-components&quot;); document.body.appendChild(document.adoptNode(webComponent)); }; &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; 123456789101112131415161718192021222324252627282930313233343536373839&lt;!-- iframe.html --&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;If&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;fancy-components&gt;&lt;/fancy-components&gt; &lt;script&gt; customElements.define( &quot;fancy-components&quot;, class extends HTMLElement { constructor() { super(); // ç›¸å½“äº Vue çš„ setup console.log(&quot;å…ˆè¿è¡Œæ„é€ å‡½æ•°&quot;); } connectedCallback() { // ç›¸å½“äº Vue çš„ mounted console.log(&quot;å†è¿è¡Œè¿æ¥å›è°ƒ&quot;); } disconnectedCallback() { // ç›¸å½“äº Vue çš„ unmounted console.log(&quot;å½“åˆ é™¤ç»„ä»¶æ—¶æ‰ä¼šè¿è¡Œå¤±è”å›è°ƒ&quot;); } adoptedCallback() { alert(&quot;iframeå†… fancy-components è¢«å¯¼å…¥&quot;); // document.adoptNode æœ‰è·¨åŸŸé™åˆ¶ğŸš« // å½“ä½¿ç”¨ document.adoptNode åä¼šè§¦å‘è¯¥ç”Ÿå‘½å‘¨æœŸ console.log(&quot;å½“ä½¿ç”¨ document.adoptNode åä¼šè¿è¡Œæ”¶å…»å›è°ƒ&quot;); } } ); &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; ä¹Ÿå¯ä»¥ç»§æ‰¿ HTML å…ƒç´  12345678910111213customElements.define( &quot;our-input&quot;, class extends HTMLInputElement { constructor() { super(); this.placeholder = &quot;å±äºæˆ‘ä»¬çš„è¾“å…¥æ¡†ï¼&quot;; this.disabled = true; } // æ‹“å±• HTMLInputElement çš„å­ç±» }, { extends: &quot;input&quot; }); ç›¸ä¿¡ä»ä»¥ä¸Šæ¡ˆä¾‹ï¼Œå·²ç»èƒ½åˆæ­¥äº†è§£ web components çš„ç”¨æ³•ï¼Œæ›´å¤šç”¨é€”åœ¨ç½‘ç»œä¸Šæœ‰æ›´ä¸°å¯Œçš„æ¡ˆä¾‹ ç»„ä»¶åº“CSS-DoodleåŸºäº web components å¼€å‘çš„ç»„ä»¶åº“,(ç‚«é…·æ•ˆæœçš„ç»„ä»¶åº“ï¼Œæ—¥å¸¸å¼€å‘ä¸­ç”¨ä¸åˆ°)css-doodle fancy-componentsèŠ±å¼ç»„ä»¶åº“, åœ¨æ—¥å¸¸å¼€å‘ä¸­ç”¨å¾—åˆ°fancy-components åœ¨æ¡†æ¶ä¸­ä½¿ç”¨React æ”¯æŒ WebComponentsåªè¦é¦–å­—æ¯ä¸å¤§å†™ï¼Œå¤§å†™æ˜¯ç»„ä»¶, å°å†™å°±æ˜¯æ ‡ç­¾ 123&lt;fc-button&gt; &lt;TextView /&gt;&lt;/fc-button&gt; Vue ä¸­æ”¯æŒ WebCompentsåœ¨ vue.config.js ä¸­ 12345678910111213141516module.exports = { chainWebpack: (config) =&gt; { config.module .rule(&quot;vue&quot;) .use(&quot;vue-loader&quot;) .tap((options) =&gt; { // ç¼–è¯‘å¿½ç•¥æŸä¸ªæ ‡ç­¾å options.compilerOptions = { ...(options.compilerOptions || {}), isCustomElement: (tag) =&gt; tag.startsWith(&quot;fc-&quot;), }; return options; }); },}; vite ä¸­ä½¿ç”¨ WebCompentsåœ¨ vite.config.js ä¸­ 123456789101112// https://vitejs.dev/config/export default defineConfig({ plugins: [ vue({ template: { compilerOptions: { isCustomElement: (tag) =&gt; tag.startsWith(&quot;fc-&quot;), }, }, }), ],});","link":"/2021/06/19/%E6%95%99%E7%A8%8B/Web%20Components%20%E5%AE%9E%E4%BE%8B/"},{"title":"Web Worker ä½¿ç”¨","text":"ç®€ä»‹Web Worker çš„ä½œç”¨ï¼Œå°±æ˜¯ä¸º JavaScript åˆ›é€ å¤šçº¿ç¨‹ç¯å¢ƒï¼Œå…è®¸ä¸»çº¿ç¨‹åˆ›å»º Worker çº¿ç¨‹ï¼Œå°†ä¸€äº›ä»»åŠ¡åˆ†é…ç»™åè€…è¿è¡Œã€‚åœ¨ä¸»çº¿ç¨‹è¿è¡Œçš„åŒæ—¶ï¼ŒWorker çº¿ç¨‹åœ¨åå°è¿è¡Œï¼Œä¸¤è€…äº’ä¸å¹²æ‰°ã€‚ ç­‰åˆ° Worker çº¿ç¨‹å®Œæˆè®¡ç®—ä»»åŠ¡ï¼Œå†æŠŠç»“æœè¿”å›ç»™ä¸»çº¿ç¨‹ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¸€äº›è®¡ç®—å¯†é›†å‹æˆ–é«˜å»¶è¿Ÿçš„ä»»åŠ¡ï¼Œè¢« Worker çº¿ç¨‹è´Ÿæ‹…äº†ï¼Œä¸»çº¿ç¨‹ï¼ˆé€šå¸¸è´Ÿè´£ UI äº¤äº’ï¼‰å°±ä¼šå¾ˆæµç•…ï¼Œä¸ä¼šè¢«é˜»å¡æˆ–æ‹–æ…¢ ä½¿ç”¨é™åˆ¶ åŒæºé™åˆ¶åˆ†é…ç»™ Worker çº¿ç¨‹è¿è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œå¿…é¡»ä¸ä¸»çº¿ç¨‹çš„è„šæœ¬æ–‡ä»¶åŒæº DOM é™åˆ¶Worker çº¿ç¨‹æ‰€åœ¨çš„å…¨å±€å¯¹è±¡ï¼Œä¸ä¸»çº¿ç¨‹ä¸ä¸€æ ·ï¼Œæ— æ³•è¯»å–ä¸»çº¿ç¨‹æ‰€åœ¨ç½‘é¡µçš„ DOM å¯¹è±¡ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨ documentã€windowã€parent è¿™äº›å¯¹è±¡ã€‚ä½†æ˜¯ï¼ŒWorker çº¿ç¨‹å¯ä»¥ navigator å¯¹è±¡å’Œ location å¯¹è±¡ã€‚ é€šä¿¡è”ç³»Worker çº¿ç¨‹å’Œä¸»çº¿ç¨‹ä¸åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå®ƒä»¬ä¸èƒ½ç›´æ¥é€šä¿¡ï¼Œå¿…é¡»é€šè¿‡æ¶ˆæ¯å®Œæˆ è„šæœ¬é™åˆ¶ä¸èƒ½æ‰§è¡Œ alert()æ–¹æ³•å’Œ confirm()æ–¹æ³•ï¼Œä½†å¯ä»¥ä½¿ç”¨ XMLHttpRequest å¯¹è±¡å‘å‡º AJAX è¯·æ±‚ æ–‡ä»¶é™åˆ¶Worker çº¿ç¨‹æ— æ³•è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œå³ä¸èƒ½æ‰“å¼€æœ¬æœºçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆfile://ï¼‰ï¼Œå®ƒæ‰€åŠ è½½çš„è„šæœ¬ï¼Œå¿…é¡»æ¥è‡ªç½‘ç»œ. ã€æœ¬åœ°å¼€å‘ä½¿ç”¨ localhostã€‘ ä½¿ç”¨ APIç»“æ„ï¼š 12345â”œâ”€â”€ index.htmlâ”œâ”€â”€ worker-helperâ”‚ â”œâ”€â”€ 1.jsâ”‚ â””â”€â”€ 2.jsâ””â”€â”€ worker.js ç¤ºä¾‹ï¼š worker ä¸­çš„å…¨å±€å¯¹è±¡æ˜¯ DedicatedWorkerGlobalScopeï¼Œå¯ä»¥å½“ä½œæ˜¯ ä¸å…·æœ‰ DOM å¯¹è±¡çš„ Window 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;!-- index.html --&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;input type=&quot;file&quot; /&gt; &lt;script&gt; const worker = new Worker(&quot;./worker.js&quot;, { name: &quot;myWorker&quot; }); // ç›‘å¬workerè¿›ç¨‹å‘é€çš„æ¶ˆæ¯ worker.onmessage = function (event) { console.log(&quot;Received message &amp; Work done!&quot; + event.data); // å…³é—­workerçº¿ç¨‹ if (event.data === &quot;close&quot;) { worker.terminate(); } }; // ç›‘å¬é”™è¯¯äº‹ä»¶ worker.onerror = function (event) { console.log(`ERROR: Line ${e.lineno} in ${e.filename} : ${e.message}`); }; // worker.postMessage çš„å‚æ•°å¯ä»¥ä¼ ç»™ Worker å„ç§æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ•°æ® worker.postMessage(&quot;Hello World&quot;); worker.postMessage({ method: &quot;echo&quot;, args: [&quot;Work&quot;] }); // setTimeout(()=&gt; { // worker.postMessage('close') // }, 3000) console.log(worker); const ab = new ArrayBuffer(100); // postMessage çš„ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ è¦è½¬ç§»åˆ° worker çº¿ç¨‹çš„å˜é‡ // è¢«è½¬ç§»çš„ å˜é‡ç±»å‹æ˜¯ ArrayBufferã€MessagePort æˆ– ImageBitmap worker.postMessage(ab, [ab]); // å°†å˜é‡è½¬ç§», ç¬¬ä¸€å‚æ•°ä¸å¯ä»¥æ˜¯åˆ«çš„ï¼Œå› ä¸º workerä¸­åªèƒ½æ¥æ”¶ç¬¬ä¸€ä¸ªå‚æ•° console.log(ab); // æ­¤æ—¶æ˜¯ ArrayBuffer(0) ä»£è¡¨å·²ä»ä¸»çº¿ç¨‹ä¸­å»é™¤ worker.addEventListener(&quot;message&quot;, function (event) { if (event.data.byteLength) { console.log(event.data); } }); &lt;/script&gt; &lt;!-- ä¹Ÿå¯ä»¥ä»¥æ ‡ç­¾çš„å½¢å¼å†™web worker --&gt; &lt;script id=&quot;worker&quot; type=&quot;app/worker&quot;&gt; addEventListener('message', function () { postMessage('some message'); }, false); &lt;/script&gt; &lt;script&gt; // ç„¶åå†è¯»å–ã€‚ã€‚ã€‚ const blob = new Blob([document.querySelector(&quot;#worker&quot;).textContent]); const url = window.URL.createObjectURL(blob); const scriptWorker = new Worker(url); scriptWorker.onmessage = function (e) { // e.data === 'some message' }; &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; ä»£ç ä¸­çš„ â€œè½¬ç§»åº•å±‚â€ çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯ postMessage çš„ ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ›´å¤šè¯·å‚è€ƒ MDN æ–‡æ¡£. SharedArrayBuffer ç±»å‹ä¸èƒ½è¢«è½¬ç§»ï¼Œå› ä¸ºå·²ç»è¢«å…±äº«ï¼ŒSharedArrayBuffer å…è®¸ Worker çº¿ç¨‹ä¸ä¸»çº¿ç¨‹å…±äº«åŒä¸€å—å†…å­˜ 12345678910111213141516171819202122232425262728293031// worker.jsconsole.log(this); // DedicatedWorkerGlobalScope {}console.log(`worker name: ${this.name}`); // myWorkeraddEventListener( &quot;message&quot;, function (e) { console.log(e); postMessage(`You said: ${e.data}`); // è‡ªèº«å…³é—­ worker çº¿ç¨‹ if (e.data === &quot;close&quot;) { close(); } if (e.data.byteLength) { // é‡æ–°ç§»äº¤ç»™ä¸»çº¿ç¨‹ postMessage(e.data, [e.data]); console.log(&quot;worker buffer&quot;, e.data); // æ­¤æ—¶çš„ e.data æ˜¯ ArrayBuffer(0) } }, false);// åŠ è½½å…¶ä»–è„šæœ¬importScripts(&quot;./worker-helper/1.js&quot;, &quot;./worker-helper/2.js&quot;);// ç›‘å¬é”™è¯¯äº‹ä»¶addEventListener(&quot;error&quot;, function (e) {});// worker ä¸­ä¹Ÿå¯ä»¥å†åˆ›å»º worker// const newWorker = new Worker('./worker-helper/1.js')","link":"/2022/07/23/%E6%95%99%E7%A8%8B/Web%20Worker%20%E4%BD%BF%E7%94%A8/"},{"title":"WebAssemblyä½¿ç”¨","text":"WebAssembly çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿè®©ä¸€äº› C æˆ– C++ ç¨‹åºï¼Œè¿è¡Œåœ¨ web ç«¯ã€‚ä¾‹å¦‚æ¸¸æˆâ€¦ é‚£ä¹ˆé¦–å…ˆå°±éœ€è¦å°† C æˆ– C++ ä»£ç ï¼Œè½¬åŒ–ä¸º js ä»£ç ï¼Œç„¶åè¿è¡Œåœ¨æµè§ˆå™¨é‡Œã€‚è½¬åŒ–åçš„è¿™ä¸ª js ä»£ç å«åš asm.js, è½¬åŒ–ä»£ç çš„ç¼–è¯‘å™¨å«åš emscripten å¦‚ä½•ä½¿ç”¨ emscriptenï¼Ÿå…ˆå»æŒ‰ç…§æ­¥éª¤ä¸‹è½½ emscriptenï¼Œæ‰§è¡Œåˆ° source ./emsdk_env.sh åé¢ï¼Œå°±å¯ä»¥ç¼–è¯‘ c ç¨‹åºäº†ã€‚ ps: æ¯æ¬¡æ‰“å¼€éƒ½è¦åœ¨ emsdk æ–‡ä»¶å¤¹ æ‰§è¡Œ source ./emsdk_env.sh ç¤ºä¾‹ï¼š 123456789101112131415161718#include &lt;emscripten.h&gt;#include &lt;iostream&gt;int main() { int val1 = 21; int val2 = EM_ASM_INT({ return $0 * 2; }, val1); std::cout &lt;&lt; &quot;Heallo WebAssembly == &quot; &lt;&lt; val2 &lt;&lt; std::endl;}// hello.cc// ä»¥ä¸‹æ˜¯ Emscripten æä¾›çš„ä¸€äº›å®// EM_ASMï¼šè°ƒç”¨ JS ä»£ç ï¼Œæ²¡æœ‰å‚æ•°ï¼Œä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚// EM_ASM_ARGSï¼šè°ƒç”¨ JS ä»£ç ï¼Œå¯ä»¥æœ‰ä»»æ„ä¸ªå‚æ•°ï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›å€¼ã€‚// EM_ASM_INTï¼šè°ƒç”¨ JS ä»£ç ï¼Œå¯ä»¥æœ‰ä»»æ„ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ã€‚// EM_ASM_DOUBLEï¼šè°ƒç”¨ JS ä»£ç ï¼Œå¯ä»¥æœ‰ä»»æ„ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚// EM_ASM_INT_Vï¼šè°ƒç”¨ JS ä»£ç ï¼Œæ²¡æœ‰å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ã€‚// EM_ASM_DOUBLE_Vï¼šè°ƒç”¨ JS ä»£ç ï¼Œæ²¡æœ‰å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚ ä¸‹é¢çš„æ“ä½œéƒ½åœ¨ emsdk æ–‡ä»¶å¤¹ä¸‹å®Œæˆ 1234567&gt; source ./emsdk_env.shSetting up EMSDK environment (suppress these messages with EMSDK_QUIET=1)Adding directories to PATH: .......&gt; emcc ï½/test/hello.cc -o ï½/test/hello.out.js&gt; emcc ï½/test/hello.cc -o ï½/test/hello.html# -o æ§åˆ¶è¾“å‡ºè·¯å¾„ ps: éœ€è¦ ç”¨ æœåŠ¡æ¥è¿è¡Œ html æ–‡ä»¶; npm i serve -g æ›´å¤š WebAssemblyâ€¦https://github.com/mbasso/awesome-wasm","link":"/2022/04/05/%E6%95%99%E7%A8%8B/WebAssembly%E4%BD%BF%E7%94%A8/"},{"title":"js å¤åˆ»ã€Šä»™å‰‘å¥‡ä¾ ä¼ ã€‹ï¼ˆä¸€ï¼‰","text":"","link":"/2023/04/10/%E6%95%99%E7%A8%8B/%E4%BB%99%E5%89%91%E5%A5%87%E4%BE%A0%E4%BC%A0(%E4%B8%80)/"},{"title":"å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•åšæ–­ç‚¹ç»­ä¼  - å‰ç«¯ç¯‡","text":"æ¨èå…ˆå»çœ‹ åç«¯ç¯‡ æ ¸å¿ƒæ€æƒ³ æ–‡ä»¶åˆ†å‰² åˆ†å‰²åå¹¶å‘è¯·æ±‚ æ¢å¤ä¼ è¾“åå†å°†åŸæ–‡ä»¶åˆ†ç‰‡ï¼Œæ ¹æ®å½“å‰å·²å‘é€çš„åˆ†ç‰‡ï¼Œè·³è¿‡ ä»£ç å®ä¾‹ å¯åŠ¨æœåŠ¡åï¼Œéœ€è¦åœ¨ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹è¿›è¡Œã€‚å¦‚æœéœ€è¦åˆ·æ–°é¡µé¢ï¼Œé‚£éœ€è¦ IndexedDB çš„ä»‹å…¥ å¯ä»¥æ‹¿ 1 ï½ 2M çš„å›¾ç‰‡æµ‹è¯• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js&quot; integrity=&quot;sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA==&quot; crossorigin=&quot;anonymous&quot; referrerpolicy=&quot;no-referrer&quot; &gt;&lt;/script&gt; &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.6/axios.min.js&quot; integrity=&quot;sha512-06NZg89vaTNvnFgFTqi/dJKFadQ6FIglD6Yg1HHWAUtVFFoXli9BZL4q4EO1UTKpOfCfW5ws2Z6gw49Swsilsg==&quot; crossorigin=&quot;anonymous&quot; referrerpolicy=&quot;no-referrer&quot; &gt;&lt;/script&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div&gt; &lt;input type=&quot;file&quot; /&gt; &lt;button onclick=&quot;bf.pause()&quot;&gt;æš‚åœä¸Šä¼ &lt;/button &gt;&lt;button onclick=&quot;bf.goOn('487f7b22f68312d2c1bbc93b1aea445b')&quot;&gt; ç»§ç»­ä¸Šä¼  &lt;/button&gt; &lt;p&gt;å·²ç»ä¸Šä¼  &lt;span&gt;&lt;/span&gt; &lt;span id=&quot;status&quot;&gt;&lt;/span&gt;&lt;/p&gt; &lt;img src=&quot;&quot; alt=&quot;&quot; /&gt; &lt;/div&gt; &lt;script&gt; class BigFiles { inputRef = document.querySelector(&quot;input[type=file]&quot;); statusRef = document.querySelector(&quot;#status&quot;); progressRef = document.querySelector(&quot;span&quot;); imgRef = document.querySelector(&quot;img&quot;); source = axios.CancelToken.source(); // è¯·æ±‚é˜Ÿåˆ— queue = []; // åˆ†ç‰‡å¤§å° (10k) splitSize = 10 * 1024; // æºæ–‡ä»¶ rawFiles = new Map(); // å·²ä¸Šä¼ çš„åˆ†ç‰‡ uploaded = {}; constructor() { // ç›‘å¬ä¸Šä¼ åŠ¨ä½œ this.inputRef.addEventListener(&quot;change&quot;, (e) =&gt; { const file = e.target.files[0]; const md5code = CryptoJS.MD5(file).toString(); this.rawFiles.set(md5code, file); this.#_uploadQueue(md5code, file); }); } // æš‚åœä¸Šä¼  pause = () =&gt; { this.source.cancel(); this.statusRef.innerText = &quot;ï¼ˆå·²æš‚åœï¼‰&quot;; }; // ç»§ç»­ä¸Šä¼  goOn = (md5code) =&gt; { axios({ url: &quot;/check_uploaded&quot;, method: &quot;get&quot;, params: { md5code, }, }).then((res) =&gt; { if (res.data.code !== 200) { return; } const goOnFile = this.rawFiles.get(md5code); if (goOnFile) { // ä¸‹é¢æ˜¯é¡µé¢åˆ·æ–°é€»è¾‘ï¼Œå¦‚æœåˆ·æ–°è¿˜éœ€è¦ç”¨IndexedDB,å­˜å‚¨æ–‡ä»¶inputé€‰ä¸­çš„æ–‡ä»¶,å’Œå·²ä¸Šä¼ çš„æ–‡ä»¶å if (!this.queue.length) { } // å‰”é™¤çŠ¶æ€æ²¡æœ‰å®Œæˆçš„è¯·æ±‚ï¼Œå†é€šè¿‡ continue push, ä¿æŒåŸåˆ†ç‰‡ä»½æ•°é•¿åº¦ï¼Œç¡®ä¿è¿›åº¦æ˜¾ç¤ºæ­£ç¡® this.queue = this.queue.filter((i) =&gt; i.status === &quot;done&quot;); /* Q: ä¸ºä»€ä¹ˆä¸å–åç«¯å­˜åœ¨çš„æ–‡ä»¶åï¼Ÿ A: å‘èµ·ä¸­æ–­çš„æƒåŠ›åœ¨å®¢æˆ·ç«¯ï¼Œä¸€æ—¦å–æ¶ˆè¯·æ±‚ï¼ŒæœåŠ¡ç«¯é‚£è¾¹å†™å‡ºçš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯æœªä¼ è¾“å®Œæˆçš„ï¼Œåˆå¹¶å‡ºçš„æ–‡ä»¶ä¼šæœ‰é—®é¢˜ï¼ */ this.uploaded[md5code] = doneList.map((d) =&gt; d.filehash); // æœ€å¥½å­˜å…¥ localStorage ä¸­ // ä¸èƒ½ç”¨å·²å–æ¶ˆçš„ abort å¯¹è±¡ï¼Œéœ€è¦é‡æ–°è®¾ç½® this.source = axios.CancelToken.source(); this.#_uploadQueue(md5code, goOnFile); this.statusRef.innerText = &quot;&quot;; } }); }; #_uploadQueue = (md5code, file) =&gt; { // file.sizeçš„æ•°å­—æ˜¯byteå°±æ˜¯å­—èŠ‚ä¸ºå•ä½ size: 1 å°±æ˜¯ 1å­—èŠ‚ let cur = 0; // ä»0å¼€å§‹ while (cur &lt; file.size) { // ä¸‹æ¬¡åˆ†ç‰‡çš„å¼€å§‹ä¸‹è¡¨çš„å¤§å° const nextCur = cur + this.splitSize; // åç«¯å­˜å‚¨çš„åˆ†ç‰‡å const filehash = `${md5code}_${nextCur}`; // å¦‚æœå·²ä¸Šä¼ å°±è·³è¿‡ if ( this.uploaded[md5code] &amp;&amp; this.uploaded[md5code].includes(filehash) ) { cur = nextCur; continue; } const formData = new FormData(); // åˆ†å‰²æ–‡ä»¶ï¼Œå¯ä»¥æŠŠæ–‡ä»¶çš„åˆ†å‰²ï¼Œçœ‹ä½œæ•°ç»„çš„åˆ†å‰² formData.append(&quot;file&quot;, file.slice(cur, (cur = nextCur))); formData.append(&quot;hash&quot;, filehash); const item = { status: &quot;&quot;, filehash, request: axios({ url: &quot;/big_files&quot;, method: &quot;post&quot;, data: formData, cancelToken: this.source.token, }).then((e) =&gt; { item.status = &quot;done&quot;; const doneList = this.queue.filter((i) =&gt; i.status === &quot;done&quot;); // ä»…åšå±•ç¤ºç”¨ï¼Œä¸éœ€è¦ç²¾ç¡®è®¡ç®— this.progressRef.innerText = `${ parseInt(doneList.length / this.queue.length) * 100 }%`; return e; }), }; // åŠ å…¥é˜Ÿåˆ— this.queue.push(item); } // å¹¶å‘é˜Ÿåˆ—ï¼Œåªä¼šè§¦å‘çŠ¶æ€ä¸º pending çš„ promise Promise.all(this.queue.map((q) =&gt; q.request)).then(() =&gt; this.mergeFiles(md5code) ); }; mergeFiles = (md5code) =&gt; { // åˆå¹¶æ–‡ä»¶è¯·æ±‚ axios({ url: &quot;/big_files_merge&quot;, method: &quot;post&quot;, data: { hashname: md5code, filename: this.rawFiles.get(md5code).name, }, responseType: &quot;blob&quot;, onDownloadProgress: (progressEvent) =&gt; { const complete = `${ parseInt(progressEvent.loaded / progressEvent.total) * 100 }%`; this.statusRef.innerText = `æ­£åœ¨åˆå¹¶å›¾åƒ, è¯·ç¨å...(${complete})`; }, }).then((res) =&gt; { // æ˜¾ç¤ºåˆ°é¡µé¢ä¸Š const URL = window.URL || window.webkitURL; const href = URL.createObjectURL(res.data); this.imgRef.src = href; this.statusRef.innerText = &quot;&quot;; this.queue = []; }); }; } const bf = new BigFiles(); &lt;/script&gt; &lt;/body&gt;&lt;/html&gt;","link":"/2020/04/23/%E6%95%99%E7%A8%8B/%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A6%82%E4%BD%95%E5%81%9A%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0-%E5%89%8D%E7%AB%AF%E7%AF%87/"},{"title":"å¤§æ–‡ä»¶ä¸Šä¼ å¦‚ä½•åšæ–­ç‚¹ç»­ä¼  - åç«¯ç¯‡","text":"æ ¸å¿ƒæ€æƒ³ æ¥æ”¶å‰ç«¯ä¼ è¾“çš„åˆ†ç‰‡ æ ¹æ®ä¼ è¾“çš„ md5 å€¼æ¥ç¡®è®¤æ˜¯å¦å·²ä¸Šä¼  å¦‚æœæœªä¸Šä¼ å®Œæˆï¼Œå‰ç«¯å°†ç»§ç»­ä¼ è¾“åˆ†ç‰‡ åˆå¹¶ä¼ è¾“å®Œæˆçš„åˆ†ç‰‡ 1234567891011# ä½ çš„ç›®å½•å·¥ä½œæ—¶ï¼Œçœ‹èµ·æ¥æ˜¯è¿™æ ·â”œâ”€â”€ imgsâ”‚ â”œâ”€â”€ 487f7b22f68312d2c1bbc93b1aea445b_10240â”‚ â”œâ”€â”€ 487f7b22f68312d2c1bbc93b1aea445b_20480â”‚ â”œâ”€â”€ 487f7b22f68312d2c1bbc93b1aea445b_30720â”‚ â”œâ”€â”€ 487f7b22f68312d2c1bbc93b1aea445b_40960â”‚ â”œâ”€â”€ 487f7b22f68312d2c1bbc93b1aea445b_51200â”‚ â”œâ”€â”€ 487f7b22f68312d2c1bbc93b1aea445b_61440â”‚ â””â”€â”€ 487f7b22f68312d2c1bbc93b1aea445b_71680â”œâ”€â”€ index.htmlâ””â”€â”€ index.js ä»£ç å®ä¾‹ä¸‹é¢å¯ç›´æ¥å¤åˆ¶è¿è¡Œ, éœ€è¦æ³¨æ„åœ°æ–¹è¾ƒå¤šï¼Œè¯·ä»”ç»†é˜…è¯»åœ¨å®é™…åº”ç”¨ä¸Šï¼Œè¿˜éœ€æ”¹é€ ã€‚ã€‚ã€‚ç”¨åˆ°äº†è®¸å¤šåŸç”Ÿ nodejs æ–¹æ³•ï¼Œå…¶ä¸­ä¸€äº›å¯ç”¨ npm åº“ä»£æ›¿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150// node -v v18.5.0const http = require(&quot;http&quot;);const fs = require(&quot;fs&quot;);const url = require(&quot;url&quot;);// å­˜å‚¨åˆ†ç‰‡æ–‡ä»¶å¤¹const tempDir = &quot;./imgs&quot;;// bufferåˆ‡å‰²æ–¹æ³•Buffer.prototype.split = function (sep) { let sepLength = sep.length, arr = [], offset = 0, currentIndex = 0; while ((currentIndex = this.indexOf(sep, offset)) !== -1) { arr.push(this.slice(offset, currentIndex)); offset = currentIndex + sepLength; } arr.push(this.slice(offset)); return arr;};// è§£æ formData æ–¹æ³•function handlePart(part) { const [head, body] = part.split(&quot;\\r\\n\\r\\n&quot;); // buffer åˆ†å‰² const headStr = head.toString(); const key = headStr.match(/name=&quot;(.+?)&quot;/)[1]; const match = headStr.match(/filename=&quot;(.+?)&quot;/); if (!match) { const value = body.toString().slice(0, -2); // æŠŠæœ«å°¾çš„ \\r\\n å»æ‰ return { key, value }; } const filename = match[1]; return { key, value: filename === &quot;blob&quot; ? body : filename };}// è¯»å–æ–‡ä»¶ï¼Œå†™æ–‡ä»¶const pipeStream = (path, writeStream) =&gt; new Promise((resolve) =&gt; { const readStream = fs.createReadStream(path); readStream.on(&quot;end&quot;, () =&gt; { fs.unlinkSync(path); resolve(); }); readStream.pipe(writeStream); });// åˆ›å»ºhttpæœåŠ¡const server = http.createServer((req, res) =&gt; { // å¤„ç† url.query const uri = url.parse(req.url, true); // è¿”å›ç›®å½•ä¸‹çš„ index.html if (uri.pathname === &quot;/&quot; &amp;&amp; req.method === &quot;GET&quot;) { res.writeHead(200, { &quot;Content-Type&quot;: &quot;text-plain&quot; }); res.end(fs.readFileSync(&quot;./index.html&quot;)); return; } // æŸ¥çœ‹æ˜¯å¦å·²ç»ä¸Šä¼  if (uri.pathname === &quot;/check_uploaded&quot; &amp;&amp; req.method === &quot;GET&quot;) { if (!uri.query.md5code) { res.end(&quot;æ²¡æœ‰md5code&quot;); return; } //TODO: åº”è¯¥å¯¹åº” MD5 å­˜å…¥ä¸€ä¸ª Map ç±»å‹çš„æ•°æ®åœ¨æœåŠ¡ä¸­ï¼Œå¯¹åº”æ˜¯å¦ booleanï¼Œå¦‚æœèµ°äº† mergeï¼Œå°±ä¸ºtrueï¼Œåˆ¤æ–­æ˜¯å¦ä¸Šä¼ å®Œæˆï¼Œè¿™é‡Œåªåšç²—ç•¥åˆ¤æ–­ const hasSplitFile = fs .readdirSync(tempDir) .some((f) =&gt; f.includes(uri.query.md5code)); res.end( JSON.stringify( hasSplitFile ? { code: 200, data: &quot;è¿˜æœªä¸Šä¼ å®Œæˆ&quot; } : { code: 404, data: &quot;è¯¥æ–‡ä»¶å·²ä¸Šä¼ å®Œæˆ&quot; } ) ); return; } // ä¸Šä¼ /å­˜å‚¨åˆ†ç‰‡ if (uri.pathname === &quot;/big_files&quot; &amp;&amp; req.method === &quot;POST&quot;) { let currentBuffer; req.on(&quot;data&quot;, (data) =&gt; { // å¦‚æœä¼ è¾“çš„æ˜¯ formData ä¼šä¼ è¾“è¿‡æ¥ Buffer ç±»å‹ï¼Œä¼ è¾“çš„ json å°±æ˜¯ å­—ç¬¦ä¸² currentBuffer = data; }); req.on(&quot;end&quot;, () =&gt; { // ä¸‹é¢è·å–formdata valueçš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨ multiparty è¿™ä¸ªåº“ï¼Œè¿™é‡Œåº”ç”¨åŸç”Ÿæ–¹æ³•å±•ç¤º // è·å– contentType: string const contentType = req.headers[&quot;content-type&quot;]; // æˆªå– header é‡Œé¢çš„ boundary éƒ¨åˆ† : --WebKitFormBoundarycBh5zHV8PGTFb5LA const headBoundary = contentType.slice(contentType.lastIndexOf(&quot;=&quot;) + 1); // å‰é¢åŠ ä¸¤ä¸ª - æ‰æ˜¯ body é‡Œé¢çœŸå®çš„åˆ†éš”ç¬¦ const bodyBoundary = `--${headBoundary}`; const obj = {}; // è½¬åŒ–formdata æ¶‰åŠåˆ° buffer åˆ†å‰² const parts = Buffer.concat([currentBuffer]) .split(bodyBoundary) .slice(1, -1); for (let i = 0; i &lt; parts.length; i++) { // formData key, formData value const { key, value } = handlePart(parts[i]); obj[key] = value; } const exist = fs.existsSync(tempDir); if (!exist) { fs.mkdirSync(tempDir); } // å¼€å§‹å†™æ–‡ä»¶ fs.writeFileSync(`${tempDir}/${obj.hash}`, obj.file); res.end(&quot;ok&quot;); }); return; } // åˆå¹¶æ–‡ä»¶ if (uri.pathname === &quot;/big_files_merge&quot; &amp;&amp; req.method === &quot;POST&quot;) { // æ¯ç‰‡çš„å¤§å°, ä¸å‰ç«¯ä¿æŒä¸€è‡´ const size = 10 * 1024; // @type {filename: string; hashname: string} const postData = {}; req.on(&quot;data&quot;, (data) =&gt; { Object.assign(postData, JSON.parse(data.toString())); }); req.on(&quot;end&quot;, () =&gt; { const files = fs.readdirSync(tempDir); // æ’åºï¼Œå¿…é¡»æŒ‰é¡ºåºè¯»å– const fileGroup = files .filter((filename) =&gt; filename.includes(postData.hashname)) .sort((a, b) =&gt; a.split(`_`)[1] - b.split(`_`)[1]); const streams = fileGroup.map((filename, index) =&gt; pipeStream( `${tempDir}/${filename}`, // å†™å…¥åŒä¸€ä¸ªæ–‡ä»¶ fs.createWriteStream(`./${postData.filename}`, { start: index * size, }) ) ); // å¹¶å‘ï¼Œè¯»å–æ–‡ä»¶åè¿”å› Promise.all(streams).then(() =&gt; { fs.rmdirSync(tempDir); fs.readFile(postData.filename, (err, buffer) =&gt; { if (err) return; res.end(buffer); }); }); }); return; }});// å¯åŠ¨server.listen(5500);","link":"/2020/04/22/%E6%95%99%E7%A8%8B/%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%A6%82%E4%BD%95%E5%81%9A%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0-%E5%90%8E%E7%AB%AF%E7%AF%87/"},{"title":"å¦‚ä½•ç”¨ç½‘é¡µè„šæœ¬è¿½è¸ªç”¨æˆ·","text":"ç‚¹å‡»åŸ‹ç‚¹ï¼šå½“ç”¨æˆ·ç‚¹å‡»å…ƒç´ æ—¶ï¼Œæ”¶é›†è¯¥ç‚¹å‡»å…ƒç´ ä¸Šçš„ä¿¡æ¯ï¼Œå¹¶è¿”å›ç»™åç«¯ æ›å…‰åŸ‹ç‚¹ï¼šå½“éœ€è¦æ›å…‰å…ƒç´ åœ¨å±å¹• ğŸ–¥ ä¸Šå‡ºç°æ—¶ï¼Œæ”¶é›†è¯¥å…ƒç´ ä¸Šçš„ä¿¡æ¯ï¼Œå¹¶è¿”å›ç»™åç«¯ æ•°æ®æ”¶é›†12&lt;button x-click=&quot;message&quot; name=&quot;common&quot;&gt;common button&lt;/button&gt;&lt;div class=&quot;export&quot; export-info=&quot;{}&quot;&gt;&lt;/div&gt; 123456789101112131415161718192021222324const pageClickInfo = {};// ç‚¹å‡»åŸ‹ç‚¹window.addEventListener(&quot;click&quot;, (event) =&gt; { // ç‚¹å‡»ç›®æ ‡å…ƒç´  const element = event.target; const name = element.getAttribute(&quot;name&quot;); // ä¿¡æ¯æ”¶é›† æˆ– xhr... name &amp;&amp; (pageClickInfo[name] = element.getAttribute(&quot;x-click&quot;));});// æ›å…‰åŸ‹ç‚¹const intersectionObserver = new IntersectionObserver( (entries) =&gt; { entries.forEach((item) =&gt; { console.log(item.target, item.intersectionRatio); // ä¿¡æ¯æ”¶é›† æˆ– xhr... }); }, { threshold: [0.5, 1] });// ä¸ºéœ€è¦æ›å…‰çš„å…ƒç´ æ·»åŠ Array.from(document.getElementsByClassName(&quot;export&quot;)).forEach((el) =&gt; { intersectionObserver.observe(el);}); æ•°æ®å‘é€é€šè¿‡ Beacon APIéœ€è¦ç”¨åˆ° Beacon APIï¼Œç”¨äºå‘é€ä¸éœ€è¦å“åº”çš„ å¼‚æ­¥ï¼Œéé˜»å¡è¯·æ±‚åˆ°æœåŠ¡å™¨ã€‚ 12345// é€šå¸¸åŸ‹ç‚¹æ•°æ®å®æ—¶å‘é€ï¼Œunload æ–¹æ³•ç”¨äºè®°å½•ç”¨æˆ·åœç•™åœ¨ç½‘é¡µçš„æ—¶é—´window.addEventListener(&quot;unload&quot;, function (event) { //åªèƒ½æ˜¯ POST è¯·æ±‚ @params { url: string, data: ArrayBufferã€ArrayBufferViewã€Blobã€DOMStringã€FormData æˆ– URLSearchParams } navigator.sendBeacon(&quot;/log&quot;, &quot;foo=bar&quot;);}); é€šè¿‡ a æ ‡ç­¾çš„ ping å±æ€§è™½ç„¶å‘é€çš„æ˜¯ POST è¯·æ±‚ï¼Œä½†åªèƒ½å‘é€ query ç±»å‹æ•°æ®ï¼Œä¸å¯æŒ‡å®š body 123&lt;a href=&quot;https://baidu.com&quot; ping=&quot;/log?foo=bar&quot;&gt; click&lt;/a&gt; åå¼¹è¿½è¸ªå°±æ˜¯ç½‘é¡µè·³è½¬æ—¶ï¼Œå…ˆè·³åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªä¸­é—´ç½‘å€ï¼Œä»¥ä¾¿æ”¶é›†ä¿¡æ¯ï¼Œç„¶åå†è·³è½¬åˆ°åŸæ¥çš„ç›®æ ‡ç½‘å€ã€‚é˜²æ­¢æˆªå– UA ä¿¡æ¯ ä»¥ç¡®ä¿ç”¨æˆ·éšç§ä¿¡æ¯ï¼Œç»å¸¸ä¼šåœ¨ ã€ç™¾åº¦æœç´¢ã€‘å’Œã€æ´‹è‘±æµè§ˆå™¨ã€‘ä¸Šè§åˆ° 12345678// &lt;a id=&quot;target&quot; href=&quot;https://baidu.com&quot;&gt;click&lt;/a&gt;const link = document.getElementById(&quot;target&quot;);link.addEventListener(&quot;click&quot;, function (event) { event.preventDefault(); const href = link.getAttribute(&quot;href&quot;); window.location.href = `/go?raw_href=${encodeURIComponent(href)}`;});","link":"/2020/02/26/%E6%95%99%E7%A8%8B/%E5%A6%82%E4%BD%95%E7%94%A8%E7%BD%91%E9%A1%B5%E8%84%9A%E6%9C%AC%E8%BF%BD%E8%B8%AA%E7%94%A8%E6%88%B7/"},{"title":"æ•™æ–°æ‰‹å‘å¸ƒåœŸç‹—å¸","text":"ä¸è®ºéª—å­ï¼ŒèµŒç‹—ï¼Œè¿˜æ˜¯æŠ•äº†åœŸç‹—å¸ç›¸ä¿¡èƒ½æš´å¯Œçš„äººã€‚æœ¬æ¥è¿™ç¯‡æ˜¯æƒ³é—®å€™å„ä½çš„å®¶äººæ¥ç€ï¼Œæ¶å¿ƒäººæ¥ç€ã€‚ä½†æˆ‘æƒ³ä¸€æƒ³ï¼Œå“ªæœ‰æ¯”ä½ ä»¬æ›´æ¶å¿ƒçš„ï¼Œå…‰éª‚ä½ ä»¬ä¸å¤Ÿï¼Œæˆ‘è¦æ¯”ä½ ä»¬æ›´æ¶å¿ƒã€‚å½’æ ¹åˆ°åº•æ˜¯å›½å†…æ²¡é‚£ä¹ˆå¤šå¯¹åŒºå—é“¾ï¼Œå¸çš„è®¤çŸ¥ã€‚ç°åœ¨æ¥æ•™æ•™å¤§å®¶æ€ä¹ˆå» å‘å¸ï¼Œæ·»åŠ æµåŠ¨æ€§ã€å˜å¾—å¯äº¤æ˜“ã€‘, ä¹°å–Kçº¿å›¾ã€‚ä½ æƒ³å—¦åˆ«äººçš„é’±ï¼Œå‘å¸äººå—¦æ­»ä½ ã€‚ å‘å¸æˆ‘ä»¬åœ¨ç½‘ä¸Šéšä¾¿æ‰¾ä¸ªå‘å¸å·¥å…· Tokentool åå­—ç•™éª—å­ä»¬è‡ªå·±æƒ³å°±è¡Œï¼Œåˆå§‹ä¾›åº”é‡æœ€å¥½ä¸Šäº¿ï¼Œæ•°å­—ä¸å¥½çœ‹å¯å°±ä¸å¥½éª—äº†å‰©ä¸‹çš„ä½ å°±çœ‹æ–‡æ¡£å‘—, äººå®¶æ–‡æ¡£éƒ½å†™äº† Tokentool æ·»åŠ æµåŠ¨æ€§å°±æ‹¿Pancake Swapä¸ºä¾‹, åœ¨å¸å®‰é“¾ä¸Šå‘å¸ƒçš„ä»£å¸ï¼Œå°±è¦åœ¨ å¸å®‰çš„ swap ä¸Šå»è§£å†³ æµåŠ¨æ€§ä»£å¸ï¼š ä½ å‘å¸ä»£å¸éƒ¨ç½²åˆçº¦çš„åœ°å€ 0x... ç§»é™¤æµåŠ¨æ€§æ²¡é”™ï¼Œè¿™æ˜¯è·‘è·¯çš„è¦ç‚¹ï¼Œå‘å¸äººæœ‰æƒæŠŠæ‰€æœ‰ä»£å¸éƒ½æ‹¿å›æ¥ï¼ŒåŒ…æ‹¬ä½ æŠ•é‡Œçš„é’±ï¼Œè¿™å°±æ˜¯åŠ¨åŠ¨æ‰‹æŒ‡çš„äº‹ ğŸ¤ŒSwap ä¹Ÿæœ‰æ–‡æ¡£, é‚£å°±ä¸åšè¿‡å¤šèµ˜è¿°äº† ä¹°å– k çº¿å›¾ç”­ç®¡ä»€ä¹ˆå¸ï¼Œä½ åªè¦æ·»åŠ äº†æµåŠ¨æ€§ï¼Œåœ¨ AVE è¿™ä¸ªé‡Œçœ‹äº¤æ˜“æ•°æ®å°±æœ‰æ˜¾ç¤ºï¼Œæœ‰æ–°éŸ­èœè¿›æ¥å°± æ¶¨ ğŸ“ˆï¼Œè€éŸ­èœå‡ºå»å°± è·Œ ğŸ“‰ã€‚æ‰€ä»¥æœ‰äº›å‘å¸äººä¹Ÿå¯ä»¥è‡ªå·±åš K çº¿ï¼Œå¤šåˆ›å»ºå‡ ä¸ªé’±åŒ…ä¸å°±å¥½äº† è§£è¯» K çº¿å›¾ï¼šå°å¼Ÿä¸æ‰ï¼Œå¦‚æœ‰å¾—ç½ªï¼Œé‚£å°±å¤ªå¥½äº†ï¼å°±æ‹¿ IPFS æ¥è¯´å¥½äº†ï¼Œfil å¸åªæ˜¯äººå®¶æ„¿æ„å‘ï¼Œè·Ÿæ„¿ä¸æ„¿ç ”å‘ IPFS æ²¡å…³ç³»ã€‚æ²¡äº† filï¼Œ IPFS ç…§æ ·æœ‰ ps: è¯´æ˜ä¸‹ï¼Œfil å¸çš„å‘è¡Œæ–¹ï¼Œå·²ç»ä¸¢æ‰äº†æ§åˆ¶æƒï¼Œå®Œå…¨æ˜¯å¸‚åœºèµ°å‘ ã€å®£ä¼ å¯¼è‡´çš„ç»“æœï¼Œäººå¿ƒæ‰€å‘çš„ç»“æœã€‘ æˆ‘å°±æ˜¯è®©æ›´å¤šäººçŸ¥é“ä½ ä»¬ä¹°çš„æ˜¯ä»€ä¹ˆï¼Œä½ ä»¬å¬åˆ°çš„æ˜¯ä»€ä¹ˆã€‚ä»¥åŠå¦‚ä½•æŒ¥èµ·ä½ ä»¬çš„å‚»é€¼å°åˆ€ï¼Œå»å‰²è´ªå©ªå°éŸ­èœ","link":"/2023/02/23/%E6%95%99%E7%A8%8B/%E6%96%B0%E6%89%8B%E5%8F%91%E5%B8%83%E5%9C%9F%E7%8B%97%E5%B8%81/"},{"title":"æµè§ˆå™¨ä¸­çš„ IndexedDB","text":"ä½œç”¨æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„æ–¹æ³•ï¼š Cookieï¼šå¤ªå° 4k Storageï¼š10M å¤Ÿï¼Œä½†ä¸èƒ½æœç´¢å’Œè‡ªå®šä¹‰ç´¢å¼• WebSQLï¼šW3C å·²ä¸ç»´æŠ¤ï¼Œæ›´æ¨è IndexDBã€‚ IndexDBï¼šæœ¬æœŸä¸»é¢˜ ç®€ä»‹æµè§ˆå™¨æä¾›çš„æœ¬åœ°æ•°æ®åº“ï¼Œå¯ä»¥è¢«ç½‘é¡µè„šæœ¬åˆ›å»ºå’Œæ“ä½œã€‚æä¾›æŸ¥æ‰¾æ¥å£ï¼Œè¿˜èƒ½å»ºç«‹ç´¢å¼•ã€‚æ›´æ¥è¿‘ NoSql IndexedDB ç‰¹ç‚¹ é”®å€¼å¯¹å‚¨å­˜ã€‚æ‰€æœ‰ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ç›´æ¥å­˜å…¥ï¼ŒåŒ…æ‹¬ JavaScript å¯¹è±¡ã€‚åœ¨åº“ä¸­ï¼Œæ•°æ®ä»¥â€é”®å€¼å¯¹â€çš„å½¢å¼ä¿å­˜ï¼Œæ¯ä¸€ä¸ªæ•°æ®è®°å½•éƒ½æœ‰å¯¹åº”çš„ä¸»é”®ï¼Œä¸»é”®æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œä¸èƒ½æœ‰é‡å¤ã€‚ å¼‚æ­¥ã€‚ IndexedDB æ“ä½œæ—¶ä¸ä¼šé”æ­»æµè§ˆå™¨ï¼Œç”¨æˆ·ä¾ç„¶å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼ŒLocalStorage çš„æ“ä½œæ˜¯åŒæ­¥çš„ã€‚å¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†é˜²æ­¢å¤§é‡æ•°æ®çš„è¯»å†™ï¼Œåšåˆ°äº†å¾ˆå¥½çš„ä¼˜åŒ–ã€‚ æ”¯æŒäº‹åŠ¡ã€‚ IndexedDB æ”¯æŒäº‹åŠ¡ï¼ˆtransactionï¼‰ï¼Œåªè¦æœ‰ä¸€æ­¥å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å°±éƒ½å–æ¶ˆï¼Œæ•°æ®åº“å›æ»šåˆ°äº‹åŠ¡å‘ç”Ÿä¹‹å‰çš„çŠ¶æ€ï¼Œä¸å­˜åœ¨åªæ”¹å†™ä¸€éƒ¨åˆ†æ•°æ®çš„æƒ…å†µã€‚ åŒæºé™åˆ¶ IndexedDB å—åˆ°åŒæºé™åˆ¶ï¼Œæ¯ä¸€ä¸ªæ•°æ®åº“å¯¹åº”åˆ›å»ºå®ƒçš„åŸŸåã€‚ç½‘é¡µåªèƒ½è®¿é—®è‡ªèº«åŸŸåä¸‹çš„æ•°æ®åº“ï¼Œè€Œä¸èƒ½è®¿é—®è·¨åŸŸçš„æ•°æ®åº“ã€‚ å‚¨å­˜ç©ºé—´å¤§ IndexedDB çš„å‚¨å­˜ç©ºé—´æ¯” LocalStorage å¤§å¾ˆå¤šï¼Œä¸å°‘äº 250MBï¼Œç”šè‡³æ²¡æœ‰ä¸Šé™ã€ä¸åŒçš„æµè§ˆå™¨è¡¨ç°ä¸åŒã€‘ã€‚ æ”¯æŒäºŒè¿›åˆ¶å‚¨å­˜ã€‚ IndexedDB ä¸ä»…å¯å­˜å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥å­˜äºŒè¿›åˆ¶æ•°æ®ï¼ˆArrayBuffer å¯¹è±¡å’Œ Blob å¯¹è±¡ï¼‰ã€‚ æµ‹è¯•æ¡ˆä¾‹ä¸‹é¢æ˜¯ä¸€æ®µå¯¹ IndexedDB çš„ç®€å•åº”ç”¨ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;IndexedDb&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;button onclick=&quot;add()&quot;&gt;æ·»åŠ ä¸€æ¡&lt;/button&gt; &lt;button onclick=&quot;getTables()&quot;&gt;è·å–å†…å®¹&lt;/button&gt; &lt;button onclick=&quot;upgrade()&quot;&gt;ä¿®æ”¹ä¸€æ¡&lt;/button&gt; &lt;button onclick=&quot;del()&quot;&gt;åˆ é™¤ä¸€æ¡&lt;/button&gt; &lt;script&gt; class IndexedDbLib { constructor(dbname, tables, version) { // ç‰ˆæœ¬å·åªèƒ½æ˜¯æ­£æ•´æ•°ï¼Œä¸”ä¸å¯å‡å°‘ï¼Œå¦‚æœç‰ˆæœ¬å·å¢åŠ è§¦å‘å‡çº§äº‹ä»¶ï¼Œå¦‚æœç‰ˆæœ¬å·å‡å°‘è§¦å‘erroräº‹ä»¶ // åˆ›å»ºäº†æ•°æ®åº“å¯¹è±¡ this.db = window.indexedDB.open(dbname, version); this.tables = tables; this.#_init(); } #_init() { // bind events --- // æ•°æ®åº“å¯¹è±¡çš„ error äº‹ä»¶ this.db.onerror = (event) =&gt; { console.log(&quot;æ•°æ®åº“æ‰“å¼€æŠ¥é”™&quot;); }; // æ•°æ®åº“å¯¹è±¡çš„ success äº‹ä»¶ this.db.onsuccess = (event) =&gt; { console.log(event.target.result); console.log(&quot;æ•°æ®åº“æ‰“å¼€æˆåŠŸ&quot;); }; // æ•°æ®åº“å‡çº§äº‹ä»¶ï¼Œæ ¹æ®ç‰ˆæœ¬å·å˜åŒ–ï¼Œæ²¡æœ‰è¯¥æ•°æ®åº“æ—¶ç›¸å½“äº 0 this.db.onupgradeneeded = (event) =&gt; { console.log(&quot;æ•°æ®åº“åˆ›å»º/å‡çº§&quot;); // æ•°æ®åº“æ–°å»ºæˆåŠŸä»¥åï¼Œå¼€å§‹æ·»åŠ è¡¨ï¼Œå»ºè¡¨æ“ä½œåªèƒ½åœ¨ æ•°æ®åº“è¢«åˆ›å»ºæ—¶æ‰§è¡Œ Object.keys(this.tables).forEach((keyName) =&gt; { let objectStore; if (this.db.result.objectStoreNames.contains(keyName)) { return; } const { keyPath, columns } = this.tables[keyName]; objectStore = this.db.result.createObjectStore(keyName, { keyPath, }); columns.forEach((col) =&gt; { const { key, options } = col; // é”®å€¼å ï¼Œç´¢å¼•åï¼Œ {unique æ˜¯å¦å”¯ä¸€} objectStore.createIndex(key, key, options); }); }); }; } addItems(tables, rowData) { // åˆ›å»ºä¸ªäº‹åŠ¡ï¼Œæ¨¡å¼ä¸º â€œè¯»å†™â€ (å¯ä»¥å¯¹å¤šä¸ªè¡¨å‘èµ·äº‹åŠ¡ï¼Œæ“ä½œæ—¶åªèƒ½é’ˆå¯¹äº‹åŠ¡é‡Œçš„å•ä¸ªè¡¨æ“ä½œ) const request = this.db.result.transaction(tables, &quot;readwrite&quot;); // ä¸ºä¸¤ä¸ªè¡¨éƒ½æ·»åŠ  tables.forEach((item) =&gt; { request.objectStore(item).add(rowData); }); request.oncomplete = (event) =&gt; { console.log(&quot;æ•°æ®å†™å…¥æˆåŠŸ&quot;); }; request.onerror = (event) =&gt; { console.log(&quot;æ•°æ®å†™å…¥å¤±è´¥&quot;); }; } deleteItems(table, id) { const request = db .transaction([table], &quot;readwrite&quot;) .objectStore(table) .delete(id); request.onsuccess = (event) =&gt; { console.log(&quot;æ•°æ®åˆ é™¤æˆåŠŸ&quot;); }; } updateItems(table, rowData) { const request = db .transaction([table], &quot;readwrite&quot;) .objectStore(table) .put(rowData); request.onsuccess = (event) =&gt; { console.log(&quot;æ•°æ®æ›´æ–°æˆåŠŸ&quot;); }; request.onerror = (event) =&gt; { console.log(&quot;æ•°æ®æ›´æ–°å¤±è´¥&quot;); }; } getItems(tables, id) { return new Promise((resolve) =&gt; { const result = {}; // get All if (!id) { const transaction = this.db.result.transaction(tables); tables.forEach((item) =&gt; { const request = transaction.objectStore(item); request.openCursor().onsuccess = (event) =&gt; { const cursor = event.target.result; if (cursor) { console.log(&quot;Id: &quot; + cursor.key); console.log(&quot;Name: &quot; + cursor.value.name); console.log(&quot;Age: &quot; + cursor.value.age); console.log(&quot;Email: &quot; + cursor.value.email); result[item] = result[item] || []; result[item].push(cursor.value); cursor.continue(); } else { console.log(&quot;æ²¡æœ‰æ›´å¤šæ•°æ®äº†ï¼&quot;); if (Object.keys(result).length === tables.length) { resolve(result); } } }; }); return; } // get Item const transaction = this.db.result.transaction(tables); tables.forEach((item) =&gt; { // è·å–ä¸»é”®å€¼ const request = transaction.objectStore(item).get(id); request.onerror = (event) =&gt; { console.log(&quot;äº‹åŠ¡å¤±è´¥&quot;); }; request.onsuccess = (event) =&gt; { if (request.result) { console.log(&quot;Name: &quot; + request.result.name); console.log(&quot;Age: &quot; + request.result.age); console.log(&quot;Email: &quot; + request.result.email); result[item] = request.result; if (Object.keys(result).length === tables.length) { resolve(result); } } else { console.log(&quot;æœªè·å¾—æ•°æ®è®°å½•&quot;); } }; }); }); } } const dbClass = new IndexedDbLib( &quot;dbname&quot;, { person: { keyPath: &quot;id&quot;, columns: [ { key: &quot;email&quot;, options: { unique: false } }, { key: &quot;name&quot;, options: { unique: true } }, { key: &quot;age&quot;, options: { unique: true } }, ], }, testTable: { keyPath: &quot;id&quot;, columns: [ { key: &quot;email&quot;, options: { unique: false } }, { key: &quot;name&quot;, options: { unique: true } }, { key: &quot;age&quot;, options: { unique: true } }, ], }, }, 1 ); const add = () =&gt; { dbClass.addItems([&quot;person&quot;, &quot;testTable&quot;], { id: 2, name: &quot;å¼ ä¸‰&quot;, age: 24, email: &quot;zhangsan@example.com&quot;, }); }; const getTables = () =&gt; { dbClass.getItems([&quot;person&quot;, &quot;testTable&quot;]).then(console.log); }; const upgrade = () =&gt; { dbClass.updateItems(&quot;person&quot;, { id: 1, name: &quot;æå››&quot;, age: 35, email: &quot;lisi@example.com&quot;, }); }; const del = () =&gt; { dbClass.deleteItems(&quot;person&quot;, 1); }; &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; IndexedDB ç›¸å…³çš„å°è£…åº“ localForageï¼šä¸€ä¸ªç®€å•çš„ Polyfillï¼Œæä¾›äº†ç®€å•çš„å®¢æˆ·ç«¯æ•°æ®å­˜å‚¨çš„å€¼è¯­æ³•ã€‚å®ƒåœ¨åå°ä½¿ç”¨ IndexedDBï¼Œå¹¶åœ¨ä¸æ”¯æŒ IndexedDB çš„æµè§ˆå™¨ä¸­å›é€€åˆ° WebSQL æˆ– localStorageã€‚ Dexie.jsï¼šIndexedDB çš„åŒ…è£…ï¼Œé€šè¿‡ç®€å•çš„è¯­æ³•ï¼Œå¯ä»¥æ›´å¿«åœ°è¿›è¡Œä»£ç å¼€å‘ã€‚ ZangoDBï¼šç±»ä¼¼ MongoDB çš„ IndexedDB æ¥å£ï¼Œæ”¯æŒ MongoDB çš„å¤§å¤šæ•°ç†Ÿæ‚‰çš„è¿‡æ»¤ã€æŠ•å½±ã€æ’åºã€æ›´æ–°å’ŒèšåˆåŠŸèƒ½ã€‚ JsStoreï¼šä¸€ä¸ªå¸¦æœ‰ SQL è¯­æ³•çš„ IndexedDB åŒ…è£…å™¨ã€‚ MiniMongoï¼šç”± localstorage æ”¯æŒçš„å®¢æˆ·ç«¯å†…å­˜ä¸­çš„ mongodbï¼Œé€šè¿‡ http è¿›è¡ŒæœåŠ¡å™¨åŒæ­¥ã€‚MeteorJS ä½¿ç”¨ MiniMongoã€‚ PouchDBï¼šä½¿ç”¨ IndexedDB åœ¨æµè§ˆå™¨ä¸­å®ç° CouchDB çš„å®¢æˆ·ç«¯ã€‚ idbï¼šä¸€ä¸ªå¾®å°çš„ï¼ˆã€œ1.15kï¼‰åº“ï¼Œå¤§å¤š API ä¸ IndexedDB ç±»ä¼¼ï¼Œä½†åšäº†ä¸€äº›å°çš„æ”¹è¿›ï¼Œè®©æ•°æ®åº“çš„å¯ç”¨æ€§å¾—åˆ°äº†å¤§å¤§çš„æå‡ã€‚ idb-keyvalï¼šä½¿ç”¨ IndexedDB å®ç°çš„è¶…çº§ç®€å•ä¸”å°å·§çš„ï¼ˆ~600Bï¼‰åŸºäº Promise çš„é”®å€¼å¯¹å­˜å‚¨ã€‚ sifrr-storageï¼šä¸€ä¸ªéå¸¸å°çš„ï¼ˆ~2kBï¼‰åŸºäº Promise çš„å®¢æˆ·ç«¯é”®å€¼æ•°æ®åº“ã€‚åŸºäº IndexedDBã€localStorageã€WebSQL å’Œ Cookies å®ç°ã€‚å®ƒå¯ä»¥è‡ªåŠ¨é€‰æ‹©ä¸Šè¿°æ”¯æŒçš„æ•°æ®åº“ï¼Œå¹¶æŒ‰ç…§ä¼˜å…ˆé¡ºåºä½¿ç”¨ã€‚ lovefieldï¼šLovefield æ˜¯ä¸€ä¸ªç”¨äº Web App çš„å…³ç³»å‹æ•°æ®åº“ï¼Œä½¿ç”¨ JavaScript ç¼–å†™ï¼Œå¯ä»¥åœ¨ä¸åŒçš„æµè§ˆå™¨ç¯å¢ƒä¸­è¿è¡Œï¼Œæä¾›äº†ç±»ä¼¼ SQL çš„ APIï¼Œé€Ÿåº¦å¿«ã€å®‰å…¨ä¸”æ˜“ç”¨ã€‚","link":"/2019/12/30/%E6%95%99%E7%A8%8B/%E6%B5%8F%E8%A7%88%E5%99%A8%20IndexedDB%20%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/"},{"title":"è’å”çš„NFTï¼ˆä¸€ï¼‰ - ä¸Šä¼ IPFSå›¾ç‰‡","text":"å‡†å¤‡å·¥ä½œ ä¸€ä¸ªè£…ç€ å›¾ç‰‡çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ€å¥½æ˜¯è¿™ç§ç»“æ„ 1234â”œâ”€â”€ 1.pngâ”œâ”€â”€ 2.pngâ”œâ”€â”€ 3.png#... å†™ä¸€ä¸ª js æ–‡ä»¶ï¼Œç”Ÿæˆè¿™ç§ metadata json 123456789101112131415161718192021222324252627282930{ &quot;name&quot;: &quot;Rabbit #1&quot;, &quot;image&quot;: &quot;ipfs://bafybeibcjaperxogvs4jhi7huxjdkwtjw4hmq7uc5mhk75kokrhbtk3shy/1.png&quot;, &quot;attributes&quot;: [ { &quot;trait_type&quot;: &quot;Background&quot;, &quot;value&quot;: &quot;Orange&quot; }, { &quot;trait_type&quot;: &quot;Scarf&quot;, &quot;value&quot;: &quot;Red&quot; }, { &quot;trait_type&quot;: &quot;Jersey&quot;, &quot;value&quot;: &quot;Argentina&quot; }, { &quot;trait_type&quot;: &quot;Face&quot;, &quot;value&quot;: &quot;White and little pink&quot; }, { &quot;trait_type&quot;: &quot;Eyes&quot;, &quot;value&quot;: &quot;Brown eyes&quot; }, { &quot;trait_type&quot;: &quot;Mouth&quot;, &quot;value&quot;: &quot;Crevice&quot; } ]} çœ‹çœ‹åˆ†åˆ«å¯¹åº”çš„ä»€ä¹ˆæ„æ€ï¼Œä½†å‡¡ä¸çéƒ½åº”è¯¥èƒ½çœ‹å‡ºæ¥â€¦ ä¸Šä¼ ä½ çš„ç­”è¾©å›¾ç‰‡æ–¹å¼ä¸€ï¼šä¸‹è½½ ipfs ä¼ è¾“è½¯ä»¶ NFT.storage å‰ææ˜¯ä½ çš„ç»ˆç«¯å¯ä»¥çˆ¬æ¢¯å­ ğŸªœ æ–¹å¼äºŒï¼š æµè§ˆå™¨å¿…é¡»æœ‰æ¢¯å­ 12git clone https://github.com/huasun47/nft.storage-browser-uploader.gitnpm i ä¸Šä¼ åçš„å›¾ç‰‡åœ°å€çœ‹èµ·æ¥æ˜¯è¿™æ ·: ipfs://bafybeibcjaperxogvs4jhi7huxjdkwtjw4hmq7uc5mhk75kokrhbtk3shy/1.png å†™å…¥ JS1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556const { join } = require(&quot;path&quot;);const { writeFile } = require(&quot;fs&quot;);const dir = &quot;./æ”¾jsonçš„æ–‡ä»¶å¤¹&quot;;const folder = join(__dirname, dir);let count = 400;const baseURI = &quot;ipfs://åœ°å€&quot;;const wirte = () =&gt; { const jsonTxt = `{ &quot;name&quot;: &quot;Rabbit #${count}&quot;, &quot;image&quot;: &quot;${baseURI}${count}.png&quot;, &quot;attributes&quot;: [ { &quot;trait_type&quot;: &quot;Background&quot;, &quot;value&quot;: &quot;Orange&quot; }, { &quot;trait_type&quot;: &quot;Scarf&quot;, &quot;value&quot;: &quot;Red&quot; }, { &quot;trait_type&quot;: &quot;Jersey&quot;, &quot;value&quot;: &quot;Argentina&quot; }, { &quot;trait_type&quot;: &quot;Face&quot;, &quot;value&quot;: &quot;White and little pink&quot; }, { &quot;trait_type&quot;: &quot;Eyes&quot;, &quot;value&quot;: &quot;Brown eyes&quot; }, { &quot;trait_type&quot;: &quot;Mouth&quot;, &quot;value&quot;: &quot;Crevice&quot; } ] }`; const fileName = join(folder, `${count}.json`); writeFile(fileName, jsonTxt, (err) =&gt; { if (err) throw err; count--; if (count &gt; 0) { wirte(); } });};wirte(); å†ä¸Šä¼  js è¾“å‡ºçš„ json æ–‡ä»¶æ˜¯çš„ï¼Œä½ çš„ NFTï¼Œå°±æ˜¯ä¸²å‚»é€¼ JSON æ–‡ä»¶ å¾—åˆ° ipfs://bafybeibcjaperxogvs4jhi7huxjdkwtjw4hmq7uc5mhk75kokrhbtk3shy/1.json ç±»ä¼¼è¿™ç§åœ°å€","link":"/2023/03/02/%E6%95%99%E7%A8%8B/%E8%8D%92%E5%94%90%E7%9A%84NFT-%E5%A6%82%E4%BD%95%E4%B8%8A%E4%BC%A0ipfs%E5%9B%BE%E7%89%87/"},{"title":"è’å”çš„NFTï¼ˆäºŒï¼‰ - Solidity å†™åˆçº¦","text":"ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258// SPDX-License-Identifier: GPL-3.0//Developer : FazelPejmanfar , Twitter :@Pejmanfarfazel/*This a Free Contract, DO NOT SELL IT*/pragma solidity &gt;=0.7.0 &lt;0.9.0;import &quot;erc721a/contracts/ERC721A.sol&quot;;import &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;import &quot;@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol&quot;;// æœ‰åŠ©äºé˜²æ­¢å¯¹å‡½æ•°çš„å¯é‡å…¥è°ƒç”¨import &quot;@openzeppelin/contracts/security/ReentrancyGuard.sol&quot;;// ç™½åå•// import &quot;@openzeppelin/contracts/utils/cryptography/MerkleProof.sol&quot;;import &quot;@openzeppelin/contracts/utils/Strings.sol&quot;;contract WorldCupRabbitNFT is ERC721A, Ownable, ReentrancyGuard { // uint256 ç±»å‹ å¯è°ƒç”¨ String çš„æ–¹æ³• .toStringä¹‹ç±»çš„ using Strings for uint256; string public baseURI; string public baseExtension = &quot;.json&quot;; // æœªå¼€å”®å›¾ç‰‡ // string public notRevealedUri; // å•ä»· uint256 public cost = 0.041 ether; // æœ€å¤§ä¾›åº”é‡ uint256 public maxSupply = 400; // å…è´¹ä¾›åº”é‡ // uint256 public FreeSupply = 2500; // æœ€å¤§ä»˜è´¹mint // uint256 public MaxperWallet = 10; // æœ€å¤§å…è´¹mint // uint256 public MaxperWalletFree = 3; bool public paused = false; // bool public revealed = false; modifier callerIsUser() { require(tx.origin == msg.sender, &quot;The caller is another contract&quot;); _; } // constructor(string memory _initBaseURI, string memory _notRevealedUri) constructor(string memory _initBaseURI) ERC721A(&quot;WorldCupRabbitNFT&quot;, &quot;Rabbit&quot;) { // change the name and symbol for your collection setBaseURI(_initBaseURI); // setNotRevealedURI(_notRevealedUri); } // internal function _baseURI() internal view virtual override returns (string memory) { return baseURI; } function _startTokenId() internal view virtual override returns (uint256) { return 1; } // public /// @dev Public mint function mint(uint256 tokens) public payable nonReentrant callerIsUser { require(!paused, &quot;oops contract is paused&quot;); // require(tokens &lt;= MaxperWallet, &quot;max mint amount per tx exceeded&quot;); require(totalSupply() + tokens &lt;= maxSupply, &quot;We Soldout&quot;); // require( // _numberMinted(_msgSenderERC721A()) + tokens &lt;= MaxperWallet, // &quot;Max NFT Per Wallet exceeded&quot; // ); require(msg.value &gt;= cost * tokens, &quot;insufficient funds&quot;); _safeMint(_msgSenderERC721A(), tokens); } /// @dev free mint // function freemint(uint256 tokens) public nonReentrant callerIsUser { // require(!paused, &quot;oops contract is paused&quot;); // require(totalSupply() + tokens &lt;= maxSupply, &quot;We Soldout&quot;); // require( // _numberMinted(_msgSenderERC721A()) + tokens &lt;= MaxperWalletFree, // &quot;Max NFT Per Wallet exceeded&quot; // ); // require(tokens &lt;= MaxperWalletFree, &quot;max mint per Tx exceeded&quot;); // require( // totalSupply() + tokens &lt;= FreeSupply, // &quot;Whitelist MaxSupply exceeded&quot; // ); // _safeMint(_msgSenderERC721A(), tokens); // } /// @dev use it for giveaway and team mint // function airdrop(uint256 _mintAmount, address destination) // public // onlyOwner // nonReentrant // callerIsUser // { // require( // totalSupply() + _mintAmount &lt;= maxSupply, // &quot;max NFT limit exceeded&quot; // ); // _safeMint(destination, _mintAmount); // } /// @notice returns metadata link of tokenid é‡å†™å†…éƒ¨ ERC721A çš„ tokenURI æ–¹æ³• function tokenURI(uint256 tokenId) public view virtual override returns (string memory) { require( _exists(tokenId), &quot;ERC721AMetadata: URI query for nonexistent token&quot; ); // if (revealed == false) { // return notRevealedUri; // } string memory currentBaseURI = _baseURI(); return bytes(currentBaseURI).length &gt; 0 ? string( abi.encodePacked( currentBaseURI, tokenId.toString(), baseExtension ) ) : &quot;&quot;; } /// @notice return the number minted by an address // function numberMinted(address owner) public view returns (uint256) { // return _numberMinted(owner); // } /// @notice return the tokens owned by an address // function tokensOfOwner(address owner) // public // view // returns (uint256[] memory) // { // unchecked { // uint256 tokenIdsIdx; // address currOwnershipAddr; // uint256 tokenIdsLength = balanceOf(owner); // uint256[] memory tokenIds = new uint256[](tokenIdsLength); // TokenOwnership memory ownership; // for ( // uint256 i = _startTokenId(); // tokenIdsIdx != tokenIdsLength; // ++i // ) { // ownership = _ownershipAt(i); // if (ownership.burned) { // continue; // } // if (ownership.addr != address(0)) { // currOwnershipAddr = ownership.addr; // } // if (currOwnershipAddr == owner) { // tokenIds[tokenIdsIdx++] = i; // } // } // return tokenIds; // } // } //only owner // function reveal(bool _state) public onlyOwner { // revealed = _state; // } /// @dev change the public max per wallet // function setMaxPerWallet(uint256 _limit) public onlyOwner { // MaxperWallet = _limit; // } /// @dev change the free max per wallet // function setFreeMaxPerWallet(uint256 _limit) public onlyOwner { // MaxperWalletFree = _limit; // } /// @dev change the public price(amount need to be in wei) // function setCost(uint256 _newCost) public onlyOwner { // cost = _newCost; // } /// @dev cut the supply if we dont sold out // function setMaxsupply(uint256 _newsupply) public onlyOwner { // maxSupply = _newsupply; // } /// @dev cut the free supply // function setFreesupply(uint256 _newsupply) public onlyOwner { // FreeSupply = _newsupply; // } /// @dev set base extension(default is .json) // function setBaseExtension(string memory _newBaseExtension) // public // onlyOwner // { // baseExtension = _newBaseExtension; // } /// @dev set hidden uri // function setNotRevealedURI(string memory _notRevealedURI) public onlyOwner { // notRevealedUri = _notRevealedURI; // } // Admin functions ---- function isOwnerCall() public view onlyOwner returns (bool) { unchecked { return owner() == _msgSenderERC721A(); } } /// @dev set your baseuri function setBaseURI(string memory _newBaseURI) public onlyOwner { _checkOwner(); unchecked { baseURI = _newBaseURI; } } function showBalance() external view onlyOwner returns (uint256) { _checkOwner(); unchecked { return address(this).balance; } } /// @dev to pause and unpause your contract(use booleans true or false) function pause(bool _state) external onlyOwner nonReentrant { _checkOwner(); unchecked { paused = _state; } } /// @dev withdraw funds from contract function withdraw() external payable onlyOwner nonReentrant { _checkOwner(); uint256 balance = address(this).balance; payable(owner()).transfer(balance); }} çœ‹çœ‹è¿™ä¸ª APIï¼šmodifier callerIsUser: æ ¡éªŒå™¨ï¼Œæ˜¯å¦æ˜¯ç”¨æˆ·è°ƒç”¨constructor(_initBaseUri): _initBaseUri åˆå§‹åŒ–æ—¶è¾“å…¥ä¸Šä¼ çš„ç­”è¾© json çš„æ–‡ä»¶å¤¹å_startTokenIdï¼šæ‰€ä»¥å«ä½ ä» 1.json å¼€å§‹å‘½åmint: è®©ä½ äº¤é’±ï¼Œäº¤æ˜“ nft çš„æ–¹æ³•tokenURI: å°±æ˜¯ json åœ°å€çš„å…¨è·¯å¾„ readonlyisOwnerCall: æ˜¯å¦æ˜¯åˆçº¦éƒ¨ç½²è€…è°ƒç”¨showBalance: æ˜¾ç¤ºä½ è¿™ä¸ªåˆçº¦é‡Œæ”¶äº†å¤šå°‘é’±äº† ETHpause: æš‚åœåˆçº¦ mint åŠŸèƒ½withdraw: å–é’±è·‘è·¯ ğŸƒ æºç  éƒ¨ç½²åˆçº¦å»åˆ«çš„åœ°æ–¹æ‰¾æ•™ç¨‹â€¦","link":"/2023/03/03/%E6%95%99%E7%A8%8B/%E8%8D%92%E5%94%90%E7%9A%84NFT-%E5%90%88%E7%BA%A6%E8%A7%A3%E6%9E%90/"},{"title":"è’å”çš„NFTï¼ˆä¸‰ï¼‰ - å‰ç«¯è°ƒç”¨åˆçº¦","text":"é¢„è§ˆåœ°å€æºç åœ°å€ æ ¸å¿ƒä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225import { useEffect, useState, useMemo } from &quot;react&quot;;import { useSelector, useDispatch } from &quot;react-redux&quot;;import InputNumber from &quot;rc-input-number&quot;;// ç”¨äºé€‰æ‹©é“¾æ¥ä½ çš„é’±åŒ…ï¼Œç§»åŠ¨H5å¯ç”¨, å¢åŠ éé’±åŒ…æ‰“å¼€ç½‘é¡µçš„é“¾æ¥é’±åŒ…ä½“éªŒimport { useConnectModal, useAccount } from &quot;@web3modal/react&quot;;// etherjs.Web3Providerimport { Web3Provider } from &quot;@ethersproject/providers&quot;;// etherjs.Contractimport { Contract } from &quot;@ethersproject/contracts&quot;;// etherjs.Unitsimport { parseEther, formatEther, formatUnits, parseUnits,} from &quot;@ethersproject/units&quot;;import { BigNumber } from &quot;@ethersproject/bignumber&quot;;import { setErrorMsg } from &quot;@/store/modules/app&quot;;// åˆçº¦ ABIimport json from &quot;@/assets/WorldCupRabbitNFT.json&quot;;import &quot;animate.css&quot;;import &quot;rc-input-number/assets/index.css&quot;;import type { RootState } from &quot;@/store&quot;;const contract_address: string = process.env.REACT_APP_CONTRACT_ADDRESS || &quot;&quot;;// è·å–ä½ metamaskä¸­çš„providerconst provider = window.ethereum ? new Web3Provider(window.ethereum) : undefined;// é“¾æ¥åˆçº¦ABIlet contract = new Contract(contract_address, json.abi, provider);// ä¸åˆçº¦ä¿æŒä¸€è‡´const price = 0.041;const max = 400;const successInfo = { msg: &quot;&quot;, hash: &quot;&quot; };const Mint = () =&gt; { const errorMsg = useSelector((state: RootState) =&gt; state.app.errorMsg); const dispatch = useDispatch(); const { open } = useConnectModal(); const { account } = useAccount(); const [paused, setPaused] = useState(false); const [lastCount, setLastCount] = useState(400); const [commonGas, setCommonGas] = useState(&quot;0&quot;); const [count, setCount] = useState(1); const [move, setMove] = useState(false); const [successMsg, setSuccessMsg] = useState({ ...successInfo }); // è·å– ä¸é’±åŒ…äº¤äº’çš„mintä¿¡æ¯ const getMintTxParams = async () =&gt; { const data = await contract.populateTransaction.mint(count); // const nonce = await contract.signer.getTransactionCount() return { ...data, // nonce, value: parseEther(totalPrice), }; }; const getCommonGas = async () =&gt; { const params = await getMintTxParams(); try { // ä¼°ç®—gasè´¹ const bigNumberGas = await contract.signer.estimateGas(params); const gas = formatUnits(bigNumberGas, &quot;gwei&quot;); setCommonGas(gas); } catch (err: any) { if (err.reason.includes(&quot;paused&quot;)) { return setPaused(true); } dispatch(setErrorMsg(err.reason)); console.dir(err); } }; // æ€»ä»·æ˜¾ç¤º const totalPrice = useMemo(() =&gt; { if (account.isConnected) { setTimeout(() =&gt; { getCommonGas(); }, 100); } const _c = BigNumber.from(count); const _p = parseUnits(`${price}`); return formatEther(_c.mul(_p)); // eslint-disable-next-line react-hooks/exhaustive-deps }, [count, account.isConnected]); // è·å–åˆçº¦ä¸­æ²¡è¢«mintçš„nft const getLastCount = async () =&gt; { const bigNum = await contract.totalSupply(); setLastCount(max - bigNum.toNumber()); }; const mint = async () =&gt; { if (!contract.signer) { return open(); } setSuccessMsg({ ...successInfo }); setMove(true); try { // è·å–äº¤æ˜“å‚æ•° const params = await getMintTxParams(); // å”¤èµ· metamaskï¼ŒåŒæ„äº¤æ˜“åˆ™æ‰§è¡Œ resolve const tx = await contract.signer.sendTransaction(params); // ç­‰å¾…äº¤æ˜“å®Œæˆ const done = await tx.wait(); if (done.transactionHash) { setSuccessMsg({ msg: `Ok! You can see it in your wallet later, or you can check`, hash: done.transactionHash, }); getLastCount(); } setMove(false); } catch (error: any) { const { action, reason } = error; console.dir(error); // JSON.stringify(error) const msg = reason ? `${action}: ${reason}` : &quot;An error has occurred. You need to try resetting your account or re importing&quot;; dispatch(setErrorMsg(msg)); setMove(false); } }; const handleChange = (nextValue: number | null) =&gt; { setCount(nextValue || count); }; useEffect(() =&gt; { if (account.address &amp;&amp; provider) { const signer = provider.getSigner(account.address); contract = contract.connect(signer); getLastCount(); } }, [account.address]); return ( &lt;&gt; &lt;div className=&quot;flex-1 mt-10 sm:mt-32 heng-bg bg-auto sm:bg-contain sm:bg-bottom&quot;&gt; &lt;div className=&quot;text-center m-auto p-8 bg-white shadow-xl rounded-lg w-11/12 sm:w-9/12 relative&quot;&gt; {paused ? ( &lt;&gt;Sorry, We Paused There&lt;/&gt; ) : lastCount === 0 ? ( &lt;&gt;Sorry, We Soldout&lt;/&gt; ) : ( &lt;&gt; &lt;div className=&quot;m-4 p-4 bg-indigo-500 text-white font-bold rounded-lg&quot;&gt; We decided that each wallet can have 10 tokens &lt;/div&gt; &lt;div className=&quot;static sm:absolute connect-font&quot;&gt; You maybe need {totalPrice} + {commonGas} ETH &lt;/div&gt; &lt;div className=&quot;static sm:absolute right-8 font-bold connect-font&quot;&gt; Last {lastCount}/400 &lt;/div&gt; &lt;div className=&quot;p-4 pt-10 mb-4&quot;&gt; &lt;InputNumber className=&quot;!text-lg !h-10&quot; min={1} max={lastCount} precision={0} onChange={handleChange} value={count} /&gt; &lt;/div&gt; &lt;button className={`mint-font text-3xl sm:text-5xl animate__animated ${ move ? &quot;animate__tada&quot; : &quot;&quot; }`} onClick={mint} disabled={move} &gt; Mint {count === 1 ? &quot;A&quot; : count} Rabbit{count === 1 ? &quot;&quot; : &quot;s&quot;}{&quot; &quot;} ! &lt;/button&gt; {!move &amp;&amp; ( &lt;div className=&quot;mt-8&quot;&gt; &lt;span className=&quot;error-font text-xl break-words&quot;&gt; {errorMsg} &lt;/span&gt; &lt;/div&gt; )} {move &amp;&amp; ( &lt;div className=&quot;mt-8&quot;&gt; &lt;span className=&quot;green-font text-xl&quot;&gt; We are mitting, please Wait ... &lt;/span&gt; &lt;/div&gt; )} {successMsg.hash &amp;&amp; ( &lt;div className=&quot;mt-8 break-words&quot;&gt; &lt;span className=&quot;green-font text-xl&quot;&gt; {successMsg.msg} on{&quot; &quot;} &lt;a className=&quot;active-font&quot; href={`https://etherscan.io/tx/${successMsg.hash}`} &gt; etherscan &lt;/a&gt; &lt;/span&gt; &lt;p&gt;{successMsg.hash}&lt;/p&gt; &lt;/div&gt; )} &lt;/&gt; )} &lt;/div&gt; &lt;/div&gt; &lt;/&gt; );};export default Mint;","link":"/2023/03/04/%E6%95%99%E7%A8%8B/%E8%8D%92%E5%94%90%E7%9A%84NFT-%E8%B0%83%E7%94%A8%E5%90%88%E7%BA%A6/"},{"title":"é˜²æ­¢ç½‘é¡µè¢«åµŒå…¥æ¡†æ¶çš„ä»£ç ","text":"ä¸ºä»€ä¹ˆåšé˜²åµŒå…¥ï¼Ÿ ä¾µçŠ¯äº†ä½œè€…çš„è‘—ä½œæƒï¼Œå’Œè®¿é—®è€…çš„çŸ¥æƒ…æƒï¼› å…·æœ‰æ¬ºéª—æ€§æé«˜çš„ç‰¹ç‚¹ï¼Œåˆ©äºä¸æ³•ç”¨é€”ï¼› å®¹æ˜“è¢«æ¤å…¥æ¶æ„è„šæœ¬ ä½¿ç”¨é˜²åµŒå…¥ä»£ç 12345678910try { top.location.hostname; // åˆ¤æ–­æ˜¯å¦ä¸ºåŒåŸŸ if (top.location.hostname !== window.location.hostname) { // ä¸æ˜¯å°±è®©æ¡†æ¶åœ°å€æŒ‡å‘è‡ªèº« top.location.href = window.location.href; }} catch (e) { top.location.href = window.location.href;}","link":"/2019/11/20/%E6%95%99%E7%A8%8B/%E9%98%B2%E6%AD%A2%E7%BD%91%E9%A1%B5%E8%A2%AB%E5%B5%8C%E5%85%A5%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BB%A3%E7%A0%81/"},{"title":"é¢è¯• - Typescript","text":"ä»€ä¹ˆæ˜¯ TypeScriptï¼Ÿ ä¸€ç§ javascript çš„è¶…é›†ï¼Œæ”¯æŒé«˜çº§ js è¯­æ³•ï¼Œä¸èƒ½é€šè¿‡æµè§ˆå™¨è¿è¡Œï¼Œéœ€è¦ç¼–è¯‘å™¨ç¼–è¯‘ä¸º js ä¸ºä»€ä¹ˆç”¨ TypeScriptï¼Ÿä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ å¯¹äºå¼€å‘äººå‘˜æ›´åŠ å‹å¥½ï¼Œæ”¯æŒæ›´é«˜çº§è¯­æ³•ã€‚ ä¸»è¦ä½“ç°åœ¨ æ›´å°‘çš„å‡ºç°å€¼çš„ç±»å‹é”™è¯¯ï¼ŒIDE å¯ä»¥è‡ªåŠ¨å¡«å……ï¼Œæ›´åŠ æ™ºèƒ½ TypeScript ä¸­ const å’Œ readonly çš„åŒºåˆ«ï¼Ÿæšä¸¾å’Œå¸¸é‡æšä¸¾çš„åŒºåˆ«ï¼Ÿæ¥å£å’Œç±»å‹åˆ«åçš„åŒºåˆ«ï¼Ÿ const å¯ä»¥ç”¨äºå˜é‡æ–­è¨€ï¼Œæ¯”è¾ƒæ–¹ä¾¿å°†å€¼å˜ä¸ºåªè¯»å†…å®¹ï¼Œreadonly ç”¨äºç±»å‹å£°æ˜ï¼Œé€šå¸¸ç”¨äºå¯¹è±¡ä¸Šçš„æŸä¸ªå±æ€§ æšä¸¾å¯æ”¯æŒçš„æ¯”è¾ƒå¹¿æ³›ï¼Œå¯å®Œæ•´æ”¯æŒå†…å¤–éƒ¨å€¼è®¡ç®—ï¼Œç¼–è¯‘çš„ç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼›å¸¸é‡æšä¸¾åªèƒ½ç”¨å®ƒå†…éƒ¨çš„å€¼è®¡ç®—ï¼Œç¼–è¯‘çš„å€¼æ˜¯å•ä¸ªå˜é‡ã€‚å¸¸ç”¨çš„è¿˜æ˜¯ æ™®é€šæšä¸¾ ç»§æ‰¿æ–¹å¼ä¸åŒï¼Œinterface ç”¨ extend å…³é”®å­—ï¼Œtype ç”¨ &amp;(å’Œå·), interface åªèƒ½ç”¨æ¥æè¿°å¯¹è±¡, è€Œä¸”é‡åçš„ interface ä¼šåˆå¹¶ï¼Œtype ä¸å¯ä»¥é‡åã€‚type è¿˜å¯ä»¥ç”¨äºå…¶ä»–ç±»å‹ï¼Œå¦‚åŸºæœ¬ç±»å‹ï¼ˆåŸå§‹å€¼ï¼‰ã€è”åˆç±»å‹ã€å…ƒç»„ã€‚ TypeScript ä¸­ any ç±»å‹çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ ä¸æ¸…æ¥šç±»å‹çš„ä¸€ä¸ªå€¼ï¼Œå€¼æ¥æºå¯èƒ½æ˜¯åŠ¨æ€çš„ï¼Œå¤±å»äº†æ£€æŸ¥ä½œç”¨ TypeScript ä¸­ anyã€neverã€unknownã€null &amp; undefined å’Œ void æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ any: åŠ¨æ€çš„å˜é‡ç±»å‹ï¼ˆå¤±å»äº†ç±»å‹æ£€æŸ¥çš„ä½œç”¨ï¼‰ never: æ˜¯ TypeScript ä¸­çš„åº•å±‚ç±»å‹ï¼Œè¡¨ç¤ºæ°¸è¿œä¸å­˜åœ¨çš„å€¼çš„ç±»å‹ã€‚ä¾‹ï¼šä¸€ä¸ªä»æ¥ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•° æˆ–è€… let foo: never; never ç±»å‹åªèƒ½èµ‹å€¼ç»™ never unknown: ä»»ä½•ç±»å‹çš„å€¼éƒ½å¯ä»¥èµ‹ç»™ unknown ç±»å‹ï¼Œä½†æ˜¯ unknown ç±»å‹çš„å€¼åªèƒ½èµ‹ç»™ unknown æœ¬èº«å’Œ any ç±»å‹ã€‚ null &amp; undefined: é»˜è®¤æƒ…å†µä¸‹ null å’Œ undefined æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹, å°±æ˜¯ä»»ä½•å€¼éƒ½å¯ä»¥æˆä¸º null æˆ– undefinedï¼Œä½†é¡¹ç›®ä¸­ä¸€èˆ¬å¼€å¯ ts å¼€å¯â€“strictNullChecks ä¸¥æ ¼æ£€æŸ¥éƒ½åªèƒ½èµ‹å€¼ç»™è‡ªèº«ç±»å‹ void: æ²¡æœ‰ä»»ä½•ç±»å‹ã€‚å‡½æ•°æ²¡æœ‰ä¸€ä¸ªè¿”å›å€¼ã€‚ undefined èƒ½èµ‹å€¼ç»™ void TypeScript ä¸­ interface å¯ä»¥ç»™ Function / Array / Classï¼ˆIndexableï¼‰åšå£°æ˜å—ï¼Ÿ å¯ä»¥ TypeScript ä¸­å¯ä»¥ä½¿ç”¨ Stringã€Numberã€Booleanã€Symbolã€Object ç­‰ç»™ç±»å‹åšå£°æ˜å—ï¼Ÿ å¯ä»¥ TypeScript ä¸­çš„ this å’Œ JavaScript ä¸­çš„ this æœ‰ä»€ä¹ˆå·®å¼‚ï¼Ÿ TypeScriptï¼šnoImplicitThis: true çš„æƒ…å†µä¸‹ï¼Œå¿…é¡»å»å£°æ˜ this çš„ç±»å‹ï¼Œæ‰èƒ½åœ¨å‡½æ•°æˆ–è€…å¯¹è±¡ä¸­ä½¿ç”¨ thisã€‚ Typescript ä¸­ç®­å¤´å‡½æ•°çš„ this å’Œ ES6 ä¸­ç®­å¤´å‡½æ•°ä¸­çš„ this æ˜¯ä¸€è‡´çš„ã€‚ TypeScript ä¸­ä½¿ç”¨ è”åˆç±»å‹è®¿é—® æ—¶æœ‰å“ªäº›æ³¨æ„äº‹é¡¹ï¼Ÿ å½“ TypeScript ä¸ç¡®å®šä¸€ä¸ªè”åˆç±»å‹çš„å˜é‡åˆ°åº•æ˜¯å“ªä¸ªç±»å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªèƒ½è®¿é—®æ­¤è”åˆç±»å‹çš„æ‰€æœ‰ç±»å‹é‡Œå…±æœ‰çš„å±æ€§æˆ–æ–¹æ³• 1234567function getLength(something: string | number): number { return something.length;}function getString(something: string | number): string { return something.toString();} TypeScript å¦‚ä½•è®¾è®¡ Class çš„å£°æ˜ï¼Ÿ åœ¨å£°æ˜ç±»çš„æ—¶å€™ï¼Œä¸€èˆ¬ç±»ä¸­éƒ½ä¼šåŒ…å«ï¼Œæ„é€ å‡½æ•°ã€å¯¹æ„é€ å‡½æ•°ä¸­çš„å±æ€§è¿›è¡Œç±»å‹å£°æ˜ã€ç±»ä¸­çš„æ–¹æ³•ã€‚ TypeScript ä¸­å¦‚ä½•è”åˆæšä¸¾ç±»å‹çš„ Key? 123456enum str { A, B, C,}type strUnion = keyof typeof str; // 'A' | 'B' | 'C' keyof å’Œ typeof å…³é”®å­—çš„ä½œç”¨ï¼Ÿ keyof è·å–ç±»å‹ä¸Šçš„ key å€¼, å¯ä½œç”¨åˆ°åŸºç¡€æ•°æ®ç±»å‹ typeof è·å–ä¸€ä¸ªå˜é‡æˆ–å¯¹è±¡çš„ç±»å‹ã€‚ 123function prop&lt;T extends object, K extends keyof T&gt;(obj: T, key: K) { return obj[key];} TypeScript ä¸­ ?.ã€??ã€!ã€!.ã€_ã€** ç­‰ç¬¦å·çš„å«ä¹‰ï¼Ÿ ?. å¯é€‰é“¾: é‡åˆ° null å’Œ undefined å¯ä»¥ç«‹å³åœæ­¢è¡¨è¾¾å¼çš„è¿è¡Œã€‚ ?? ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦: å½“å·¦ä¾§æ“ä½œæ•°ä¸º null æˆ– undefined æ—¶ï¼Œå…¶è¿”å›å³ä¾§çš„æ“ä½œæ•°ï¼Œå¦åˆ™è¿”å›å·¦ä¾§çš„æ“ä½œæ•°ã€‚å¯ä»¥æŠŠå®ƒçœ‹ä½œ || ï¼Œåªæ˜¯ä¸åŒ…å« 0 ! éç©ºæ–­è¨€è¿ç®—ç¬¦: x! å°†ä» x å€¼åŸŸä¸­æ’é™¤ null å’Œ undefinedã€‚å°±æ˜¯å°†è¯¥å˜é‡å†…çš„ null å’Œ undefined å‰”é™¤ï¼Œä½¿å…¶å¯ä»¥èµ‹å€¼ ä¾‹ï¼šx!.toFixed(2) æ’é™¤äº† x æ˜¯ null å’Œ undefined çš„æƒ…å†µå»ä½¿ç”¨æ–¹æ³• !. åœ¨å˜é‡ååæ·»åŠ ï¼Œå¯ä»¥æ–­è¨€æ’é™¤ undefined å’Œ null ç±»å‹ _ æ•°å­—åˆ†å‰²ç¬¦ï¼š åˆ†éš”ç¬¦ä¸ä¼šæ”¹å˜æ•°å€¼å­—é¢é‡çš„å€¼ï¼Œä½¿äººæ›´å®¹æ˜“è¯»æ‡‚æ•°å­— ä¾‹ï¼š1_101_324 ** æ±‚å¹‚ é€»è¾‘è¿ç®—ç¬¦: ||= , &amp;&amp;= , ??= ç®€å•ä»‹ç»ä¸€ä¸‹ TypeScript æ¨¡å—çš„åŠ è½½æœºåˆ¶ï¼Ÿ é¦–å…ˆï¼Œç¼–è¯‘å™¨ä¼šå°è¯•å®šä½éœ€è¦å¯¼å…¥çš„æ¨¡å—æ–‡ä»¶ï¼Œé€šè¿‡ç»å¯¹æˆ–è€…ç›¸å¯¹çš„è·¯å¾„æŸ¥æ‰¾æ–¹å¼ å¦‚æœæ²¡æœ‰æŸ¥æ‰¾åˆ°å¯¹åº”çš„æ¨¡å—ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•å®šä½ä¸€ä¸ªå¤–éƒ¨æ¨¡å—å£°æ˜ï¼ˆ.d.tsï¼‰ å¦‚æœè¿˜æ²¡æ‰¾åˆ°å°±æŠ¥é”™ TypeScript ä¸­å¯¹è±¡å±•å¼€ä¼šæœ‰ä»€ä¹ˆå‰¯ä½œç”¨å—ï¼Ÿ å±•å¼€å¯¹è±¡åé¢çš„å±æ€§ä¼šè¦†ç›–å‰é¢çš„å±æ€§ï¼› ä»…åŒ…å«å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾å±æ€§ï¼Œä¸å¯æšä¸¾çš„å±æ€§å°†ä¼šä¸¢å¤±ã€‚ ç±»å‹çš„å…¨å±€å£°æ˜å’Œå±€éƒ¨å£°æ˜? æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦åŒ…å« importã€exportï¼Œä¸åŒ…å«å°±æ˜¯å…¨å±€å£°æ˜ TypeScript ä¸­åŒåçš„ interface æˆ–è€…åŒåçš„ interface å’Œ class å¯ä»¥åˆå¹¶å—ï¼Ÿ åŒåçš„ interface ä¼šè‡ªåŠ¨åˆå¹¶ï¼Œclass ä¼šè‡ªåŠ¨ä½¿ç”¨åŒåçš„ interface å¦‚ä½•ä½¿ TypeScript é¡¹ç›®å¼•å…¥å¹¶è¯†åˆ«ç¼–è¯‘ä¸º JavaScript çš„ npm åº“åŒ…ï¼Ÿ é€‰æ‹©å®‰è£… ts ç‰ˆæœ¬ï¼Œnpm install @types/åŒ…å â€“saveï¼› å¯¹äºæ²¡æœ‰ç±»å‹çš„ js åº“ï¼Œéœ€è¦ç¼–å†™åŒåçš„.d.ts æ–‡ä»¶ TypeScript çš„ tsconfig.json ä¸­æœ‰å“ªäº›é…ç½®é¡¹ä¿¡æ¯ï¼Ÿ files æ˜¯ä¸€ä¸ªæ•°ç»„åˆ—è¡¨ï¼Œç”¨æ¥æŒ‡å®šå¾…ç¼–è¯‘æ–‡ä»¶ï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™åªä¼šç¼–è¯‘åŒ…å«åœ¨ files ä¸­åˆ—å‡ºçš„æ–‡ä»¶ã€‚ã€ include &amp; exclude æŒ‡å®šç¼–è¯‘æŸäº›æ–‡ä»¶ï¼Œæˆ–è€…æŒ‡å®šæ’é™¤æŸäº›æ–‡ä»¶ã€‚ compileOnSaveï¼štrue è®© IDE åœ¨ä¿å­˜æ–‡ä»¶çš„æ—¶å€™æ ¹æ® tsconfig.json é‡æ–°ç”Ÿæˆæ–‡ä»¶ã€‚ extends å¯ä»¥é€šè¿‡æŒ‡å®šä¸€ä¸ªå…¶ä»–çš„ tsconfig.json æ–‡ä»¶è·¯å¾„ï¼Œæ¥ç»§æ‰¿è¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œçš„é…ç½®ã€‚ compilerOptions ç¼–è¯‘é…ç½®é¡¹ï¼Œå¦‚ä½•å¯¹å…·ä½“çš„ ts æ–‡ä»¶è¿›è¡Œç¼–è¯‘ TypeScript ä¸­å¦‚ä½•è®¾ç½®æ¨¡å—å¯¼å…¥çš„è·¯å¾„åˆ«åï¼Ÿ é€šè¿‡ tsconfig.json ä¸­çš„ compilerOptions.paths é¡¹æ¥é…ç½® declareï¼Œdeclare global æ˜¯ä»€ä¹ˆï¼Ÿ declare æ˜¯ç”¨æ¥å®šä¹‰å…¨å±€å˜é‡ã€å…¨å±€å‡½æ•°ã€å…¨å±€å‘½åç©ºé—´ã€å…¨å±€æ¨¡å—ã€class ç­‰ declare global ä¸ºå…¨å±€å¯¹è±¡ window å¢åŠ æ–°çš„å±æ€§ å¯¹ TypeScript ç±»ä¸­æˆå‘˜çš„ publicã€privateã€protectedã€readonly ä¿®é¥°ç¬¦çš„ç†è§£ï¼Ÿ public: æˆå‘˜éƒ½é»˜è®¤ä¸º publicï¼Œè¢«æ­¤é™å®šç¬¦ä¿®é¥°çš„æˆå‘˜æ˜¯å¯ä»¥è¢«å¤–éƒ¨è®¿é—®ï¼› private: è¢«æ­¤é™å®šç¬¦ä¿®é¥°çš„æˆå‘˜æ˜¯åªå¯ä»¥è¢«ç±»çš„å†…éƒ¨è®¿é—®ï¼› protected: è¢«æ­¤é™å®šç¬¦ä¿®é¥°çš„æˆå‘˜æ˜¯åªå¯ä»¥è¢«ç±»çš„å†…éƒ¨ä»¥åŠç±»çš„å­ç±»è®¿é—®; readonly: å…³é”®å­—å°†å±æ€§è®¾ç½®ä¸ºåªè¯»çš„ã€‚ åªè¯»å±æ€§å¿…é¡»åœ¨å£°æ˜æ—¶æˆ–æ„é€ å‡½æ•°é‡Œè¢«åˆå§‹åŒ–ã€‚ ç®€è¿°å·¥å…·ç±»å‹ Excludeã€Omitã€Mergeã€Intersectionã€Overwrite çš„ä½œç”¨ã€‚ Exclude&lt;T, U&gt; ä» T ä¸­æ’é™¤å‡ºå¯åˆ†é…ç»™ U çš„å…ƒç´ ã€‚ Omit&lt;T, K&gt; çš„ä½œç”¨æ˜¯å¿½ç•¥ T ä¸­çš„æŸäº›å±æ€§ã€‚ Merge&lt;O1, O2&gt; æ˜¯å°†ä¸¤ä¸ªå¯¹è±¡çš„å±æ€§åˆå¹¶ã€‚ Compute&lt;A &amp; B&gt; æ˜¯å°†äº¤å‰ç±»å‹åˆå¹¶ Intersection&lt;T, U&gt;çš„ä½œç”¨æ˜¯å– T çš„å±æ€§,æ­¤å±æ€§åŒæ ·ä¹Ÿå­˜åœ¨ä¸ U Overwrite&lt;T, U&gt; æ˜¯ç”¨ U çš„å±æ€§è¦†ç›– T çš„ç›¸åŒå±æ€§ã€‚ Patrial&lt; T &gt; è½¬åŒ–ä¸ºéå¿…é€‰ç±»å‹ã€‚ æ³›å‹çš„ä½¿ç”¨åœºæ™¯ï¼Ÿ ä¹¦å†™ä¸Šï¼šæ³›å‹å®é™…ä¸Šå°±æ˜¯ å¤§å†™å­—æ¯å¼€å¤´çš„ ä¸€ä¸ª å•è¯æˆ–å­—æ¯ï¼Œéœ€è¦å†™å…¥å°–æ‹¬å·å†…ä½œä¸ºä¸€ä¸ªç±»å‹ä¼ å…¥ æ„ä¹‰ä¸Šï¼šé€šå¸¸ä»£è¡¨ä¸€ç§ä¸ç¡®å®šçš„ç±»å‹ï¼Œå¯ä»¥ç†è§£ä¸ºç±»å‹ç›¸å½“äºå€¼ï¼Œä¼ å…¥äº† Interface, Class æˆ– Function ä¸­ã€‚ç»å¸¸ä¸ extend æ­é…ä½¿ç”¨ï¼Œä»£è¡¨æŸäº›ç±»å‹çš„å­ç±»è¡¨è¾¾ä¸æ¯”å¦‚ &lt;T extend unknown &gt; é‚£ä¹ˆ T å°±å¯ä»¥æ˜¯ number, string æˆ–å…¶ä»–å¯ä»¥èµ‹å€¼ç»™ unknown çš„ç±»å‹","link":"/2023/02/07/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%20-%20Typescript/"},{"title":"ä¸Šå¤æ–‡ä»¶ .mkf è¯»å–ï¼Œç†è§£ Dataviewï¼ŒTypeArray","text":"ç®€ä»‹mkf æ–‡ä»¶æ˜¯å°†å›¾ç‰‡ä»¥äºŒè¿›åˆ¶å­˜å‚¨çš„ä¸€ç§å‹ç¼©æŠ€æœ¯","link":"/2023/05/10/%E6%95%99%E7%A8%8B/%E4%B8%8A%E5%8F%A4%E6%96%87%E4%BB%B6mkf%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"title":"js å¤åˆ»ã€Šä»™å‰‘å¥‡ä¾ ä¼ ã€‹ï¼ˆå‰è¨€ï¼‰","text":"è‡ªæˆ‘é—®é¢˜æ’é™¤Q: ä¸ºä»€ä¹ˆè¦åšï¼ŸA: æƒ…æ€€ï¼Œå•çº¯æƒ³æå‡è‡ªå·±ï¼Œè¿˜æ˜¯ç©æ¸¸æˆçš„äººèˆ’æœ Q: æœ‰ä»€ä¹ˆéš¾åº¦å—ï¼ŸA: æœ‰ï¼Œå¯¹æˆ‘æ¥è¯´å¾ˆå¤§ï¼Œéœ€è¦å»è¯»æ‡‚åŸä»™å‰‘ä¸€çš„ C++ä»£ç , å¹¶ç”¨ JS å¤åˆ»å‡ºæ¥ã€‚æˆ‘æœŸæœ›å¹¶ä¸æ˜¯ç”¨ WASM è½¬ä¸€ä¸‹å°±è¡Œ Q: æœ‰å¯ä»¥å‚ç…§çš„æ¡ˆä¾‹å—ï¼ŸA: åªæœ‰ä¸€ä¸ªï¼Œåªä¸è¿‡è¿™ä½å¤§ç¥åœ¨åå¹´å‰åœåšäº† Sivory/pal.jsã€‚ è¿˜æœ‰ä¸€ä¸ªå·²ç»æœ‰ç”¨ è™šå¹»å¼•æ“ï¼ˆUEï¼‰å¤åˆ»çš„åŠæˆå“ wrsuperboy/UEPALï¼Œä½†ä¹Ÿå±äº C++å¯¹æœ¬ç³»åˆ—æ— å…³ã€‚å…¨ç½‘è€å­æ˜¯å³å°†æˆä¸ºçš„ç¬¬ä¸‰ä¸ª æŠ€æœ¯é—®é¢˜æ’é™¤Q: ä¸ºä»€ä¹ˆä¸ç”¨ Cocos è¿™ç§ç°ä»£å¼•æ“åšï¼ŸA: æ¯•ç«Ÿåšè·¨è¯­è¨€å¤åˆ»ï¼Œä¸€æ­¥åˆ°ä½å¯¹æˆ‘å­˜åœ¨éš¾åº¦ã€‚è€Œä¸”åŸä»£ç ä¸å­˜åœ¨åœºæ™¯ï¼Œæ‘„åƒæœºï¼Œçº¹ç†çš„æ¦‚å¿µã€‚å…¨éƒ¨æ˜¯è¯»å– mkf æ–‡ä»¶ + åƒç´ åç§»ï¼Œäººç‰©é»˜è®¤åœ¨ä¸­å¤®ï¼Œç»˜åˆ¶åœ¨ç•Œé¢ä¸Š Q: è½¬æ¢è¿‡ç¨‹æœ‰ä»€ä¹ˆå›°éš¾çš„ï¼ŸA: åŸä»™å‰‘ä¸€ä¾èµ– SDL2 æ¡†æ¶çš„ç‰¹æ€§ã€‚ç¨‹åºå†…å­˜åœ¨å¤šå¾ªç¯ï¼Œè€Œåšä¸åˆ°å”¯ä¸€ä¸»å¾ªç¯ï¼Œä¼šä½¿æˆ‘æ›´åŠ éš¾ä»¥ç†è§£ï¼› mkf æ–‡ä»¶å¦‚ä½•è½¬æ¢ä¸ºå›¾ç‰‡å¹¶è¾“å‡ºåˆ° canvas ä¸Šé¢ï¼Œmkf æ˜¯ä¸€ç§ç¨‹åºçš„é»˜è®¤å‹ç¼©æ–‡ä»¶ã€‚å‹ç¼©ä½“ç§¯éå¸¸å°ï¼Œæ˜¯æ™®é€š png å›¾ç‰‡çš„1/5 ä½†éœ€è¦ç ”ç©¶å¦‚ä½•è¯»å–ï¼Œç›®å‰å·²çŸ¥éœ€ä» ArrayBuffer è½¬åˆ° UniCodeï¼Œä¹‹åå¯èƒ½ä¼šå•ç‹¬å‡ºä¸€ç¯‡è®² mkf","link":"/2023/04/04/%E6%95%99%E7%A8%8B/%E4%BB%99%E5%89%91%E5%A5%87%E4%BE%A0%E4%BC%A0(%E5%89%8D%E8%A8%80)/"}],"tags":[{"name":"Nodejs","slug":"Nodejs","link":"/tags/Nodejs/"},{"name":"Typescript","slug":"Typescript","link":"/tags/Typescript/"}],"categories":[{"name":"é¢è¯•","slug":"é¢è¯•","link":"/categories/%E9%9D%A2%E8%AF%95/"}],"pages":[]}